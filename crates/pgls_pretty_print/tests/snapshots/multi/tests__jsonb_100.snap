---
source: crates/pgls_pretty_print/tests/tests.rs
input_file: crates/pgls_pretty_print/tests/data/multi/jsonb.sql
snapshot_kind: text
---
create table testjsonb (j JSONB);

copy testjsonb from 'filename';

select cast('""' as JSONB);

select cast('''''' as JSONB);

select cast('"abc"' as JSONB);

select cast('"abc' as JSONB);

select cast('"abc
def"' as JSONB);

select cast('"\n\"\\"' as JSONB);

select cast('"\v"' as JSONB);

select cast('1' as JSONB);

select cast('0' as JSONB);

select cast('01' as JSONB);

select cast('0.1' as JSONB);

select cast('9223372036854775808' as JSONB);

select cast('1e100' as JSONB);

select cast('1.3e100' as JSONB);

select cast('1f2' as JSONB);

select cast('0.x1' as JSONB);

select cast('1.3ex100' as JSONB);

select cast('[]' as JSONB);

select
  cast('[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]'
  as JSONB);

select cast('[1,2]' as JSONB);

select cast('[1,2,]' as JSONB);

select cast('[1,2' as JSONB);

select cast('[1,[2]' as JSONB);

select cast('{}' as JSONB);

select cast('{"abc"}' as JSONB);

select cast('{"abc":1}' as JSONB);

select cast('{1:"abc"}' as JSONB);

select cast('{"abc",1}' as JSONB);

select cast('{"abc"=1}' as JSONB);

select cast('{"abc"::1}' as JSONB);

select cast('{"abc":1,"def":2,"ghi":[3,4],"hij":{"klm":5,"nop":[6]}}' as JSONB);

select cast('{"abc":1:2}' as JSONB);

select cast('{"abc":1,3}' as JSONB);

set max_stack_depth = '100kB';

select cast(repeat('[', 10000) as JSONB);

select cast(repeat('{"a":', 10000) as JSONB);

reset max_stack_depth;

select cast('true' as JSONB);

select cast('false' as JSONB);

select cast('null' as JSONB);

select cast(' true ' as JSONB);

select cast('true false' as JSONB);

select cast('true, false' as JSONB);

select cast('truf' as JSONB);

select cast('trues' as JSONB);

select cast('' as JSONB);

select cast('    ' as JSONB);

select cast('{
		"one": 1,
		"two":"two",
		"three":
		true}' as JSONB);

select
  cast('{
		"one": 1,
		"two":,"two",  -- ERROR extraneous comma before field "two"
		"three":
		true}'
  as JSONB);

select
  cast('{
		"one": 1,
		"two":"two",
		"averyveryveryveryveryveryveryveryveryverylongfieldname":}'
  as JSONB);

select pg_input_is_valid('{"a":true}', 'jsonb');

select pg_input_is_valid('{"a":true', 'jsonb');

select * from pg_input_error_info('{"a":true', 'jsonb');

select * from pg_input_error_info('{"a":1e1000000}', 'jsonb');

select array_to_json(array[cast('{"a":1}' as JSONB), cast('{"b":[2,3]}' as JSONB)]);

create temporary table rows as select x, 'txt' || x as y from generate_series(1, 3) as x;

analyze rows;

select
  attname,
  to_jsonb(histogram_bounds) as histogram_bounds
from
  pg_stats
where
  tablename = 'rows' and
  schemaname =
  cast(cast(pg_my_temp_schema() as regnamespace)
  as TEXT)
order by 1;

select to_jsonb(cast('2014-05-28 12:22:35.614298' as TIMESTAMP));

begin;

set local time zone 10.5;

select to_jsonb(cast('2014-05-28 12:22:35.614298-04' as timestamp with time ZONE));

set local time zone -8;

select to_jsonb(cast('2014-05-28 12:22:35.614298-04' as timestamp with time ZONE));

commit;

select to_jsonb(cast('2014-05-28' as DATE));

select to_jsonb(cast('Infinity' as DATE));

select to_jsonb(cast('-Infinity' as DATE));

select to_jsonb(cast('Infinity' as TIMESTAMP));

select to_jsonb(cast('-Infinity' as TIMESTAMP));

select to_jsonb(cast('Infinity' as timestamp with time ZONE));

select to_jsonb(cast('-Infinity' as timestamp with time ZONE));

select
  jsonb_agg(q)
from
  (
    select
      'a' || x as b,
      y as c,
      array[row(x.*, array[1, 2, 3]),
      row(y.*, array[4, 5, 6])]
      as z
    from
      generate_series(1, 2) as x,
      generate_series(4, 5) as y
  )
  as q;

select jsonb_agg(q order by x, y) from rows as q;

update rows set x = null where x = 1;

select jsonb_agg(q order by x nulls first, y) from rows as q;

create temporary table test_jsonb (
  json_type TEXT,
  test_json JSONB
);

insert into test_jsonb
values
  ('scalar', '"a scalar"'),
  (
    'array',
    '["zero", "one","two",null,"four","five", [1,2,3],{"f1":9}]'
  ),
  (
    'object',
    '{"field1":"val1","field2":"val2","field3":null, "field4": 4, "field5": [1,2,3], "field6": {"f1":9}}'
  );

select test_json -> 'x' from test_jsonb where json_type = 'scalar';

select test_json -> 'x' from test_jsonb where json_type = 'array';

select test_json -> 'x' from test_jsonb where json_type = 'object';

select test_json -> 'field2' from test_jsonb where json_type = 'object';

select test_json ->> 'field2' from test_jsonb where json_type = 'scalar';

select test_json ->> 'field2' from test_jsonb where json_type = 'array';

select test_json ->> 'field2' from test_jsonb where json_type = 'object';

select test_json -> 2 from test_jsonb where json_type = 'scalar';

select test_json -> 2 from test_jsonb where json_type = 'array';

select test_json -> 9 from test_jsonb where json_type = 'array';

select test_json -> 2 from test_jsonb where json_type = 'object';

select test_json ->> 6 from test_jsonb where json_type = 'array';

select test_json ->> 7 from test_jsonb where json_type = 'array';

select test_json ->> 'field4' from test_jsonb where json_type = 'object';

select test_json ->> 'field5' from test_jsonb where json_type = 'object';

select test_json ->> 'field6' from test_jsonb where json_type = 'object';

select test_json ->> 2 from test_jsonb where json_type = 'scalar';

select test_json ->> 2 from test_jsonb where json_type = 'array';

select test_json ->> 2 from test_jsonb where json_type = 'object';

select jsonb_object_keys(test_json) from test_jsonb where json_type = 'scalar';

select jsonb_object_keys(test_json) from test_jsonb where json_type = 'array';

select jsonb_object_keys(test_json) from test_jsonb where json_type = 'object';

select test_json -> 'field3' is null as expect_false from test_jsonb where json_type = 'object';

select test_json ->> 'field3' is null as expect_true from test_jsonb where json_type = 'object';

select test_json -> 3 is null as expect_false from test_jsonb where json_type = 'array';

select test_json ->> 3 is null as expect_true from test_jsonb where json_type = 'array';

select cast('{"a": [{"b": "c"}, {"b": "cc"}]}' as JSONB) -> cast(null as TEXT);

select cast('{"a": [{"b": "c"}, {"b": "cc"}]}' as JSONB) -> cast(null as INT);

select cast('{"a": [{"b": "c"}, {"b": "cc"}]}' as JSONB) -> 1;

select cast('{"a": [{"b": "c"}, {"b": "cc"}]}' as JSONB) -> 'z';

select cast('{"a": [{"b": "c"}, {"b": "cc"}]}' as JSONB) -> '';

select cast('[{"b": "c"}, {"b": "cc"}]' as JSONB) -> 1;

select cast('[{"b": "c"}, {"b": "cc"}]' as JSONB) -> 3;

select cast('[{"b": "c"}, {"b": "cc"}]' as JSONB) -> 'z';

select cast('{"a": "c", "b": null}' as JSONB) -> 'b';

select cast('"foo"' as JSONB) -> 1;

select cast('"foo"' as JSONB) -> 'z';

select cast('[]' as JSONB) -> -2147483648;

select cast('{"a": [{"b": "c"}, {"b": "cc"}]}' as JSONB) ->> cast(null as TEXT);

select cast('{"a": [{"b": "c"}, {"b": "cc"}]}' as JSONB) ->> cast(null as INT);

select cast('{"a": [{"b": "c"}, {"b": "cc"}]}' as JSONB) ->> 1;

select cast('{"a": [{"b": "c"}, {"b": "cc"}]}' as JSONB) ->> 'z';

select cast('{"a": [{"b": "c"}, {"b": "cc"}]}' as JSONB) ->> '';

select cast('[{"b": "c"}, {"b": "cc"}]' as JSONB) ->> 1;

select cast('[{"b": "c"}, {"b": "cc"}]' as JSONB) ->> 3;

select cast('[{"b": "c"}, {"b": "cc"}]' as JSONB) ->> 'z';

select cast('{"a": "c", "b": null}' as JSONB) ->> 'b';

select cast('"foo"' as JSONB) ->> 1;

select cast('"foo"' as JSONB) ->> 'z';

select cast('[]' as JSONB) ->> -2147483648;

select cast('{"x":"y"}' as JSONB) = cast('{"x":"y"}' as JSONB);

select cast('{"x":"y"}' as JSONB) = cast('{"x":"z"}' as JSONB);

select cast('{"x":"y"}' as JSONB) <> cast('{"x":"y"}' as JSONB);

select cast('{"x":"y"}' as JSONB) <> cast('{"x":"z"}' as JSONB);

select jsonb_contains('{"a":"b", "b":1, "c":null}', '{"a":"b"}');

select jsonb_contains('{"a":"b", "b":1, "c":null}', '{"a":"b", "c":null}');

select jsonb_contains('{"a":"b", "b":1, "c":null}', '{"a":"b", "g":null}');

select jsonb_contains('{"a":"b", "b":1, "c":null}', '{"g":null}');

select jsonb_contains('{"a":"b", "b":1, "c":null}', '{"a":"c"}');

select jsonb_contains('{"a":"b", "b":1, "c":null}', '{"a":"b"}');

select jsonb_contains('{"a":"b", "b":1, "c":null}', '{"a":"b", "c":"q"}');

select cast('{"a":"b", "b":1, "c":null}' as JSONB) @> '{"a":"b"}';

select cast('{"a":"b", "b":1, "c":null}' as JSONB) @> '{"a":"b", "c":null}';

select cast('{"a":"b", "b":1, "c":null}' as JSONB) @> '{"a":"b", "g":null}';

select cast('{"a":"b", "b":1, "c":null}' as JSONB) @> '{"g":null}';

select cast('{"a":"b", "b":1, "c":null}' as JSONB) @> '{"a":"c"}';

select cast('{"a":"b", "b":1, "c":null}' as JSONB) @> '{"a":"b"}';

select cast('{"a":"b", "b":1, "c":null}' as JSONB) @> '{"a":"b", "c":"q"}';

select cast('[1,2]' as JSONB) @> cast('[1,2,2]' as JSONB);

select cast('[1,1,2]' as JSONB) @> cast('[1,2,2]' as JSONB);

select cast('[[1,2]]' as JSONB) @> cast('[[1,2,2]]' as JSONB);

select cast('[1,2,2]' as JSONB) <@ cast('[1,2]' as JSONB);

select cast('[1,2,2]' as JSONB) <@ cast('[1,1,2]' as JSONB);

select cast('[[1,2,2]]' as JSONB) <@ cast('[[1,2]]' as JSONB);

select jsonb_contained('{"a":"b"}', '{"a":"b", "b":1, "c":null}');

select jsonb_contained('{"a":"b", "c":null}', '{"a":"b", "b":1, "c":null}');

select jsonb_contained('{"a":"b", "g":null}', '{"a":"b", "b":1, "c":null}');

select jsonb_contained('{"g":null}', '{"a":"b", "b":1, "c":null}');

select jsonb_contained('{"a":"c"}', '{"a":"b", "b":1, "c":null}');

select jsonb_contained('{"a":"b"}', '{"a":"b", "b":1, "c":null}');

select jsonb_contained('{"a":"b", "c":"q"}', '{"a":"b", "b":1, "c":null}');

select cast('{"a":"b"}' as JSONB) <@ '{"a":"b", "b":1, "c":null}';

select cast('{"a":"b", "c":null}' as JSONB) <@ '{"a":"b", "b":1, "c":null}';

select cast('{"a":"b", "g":null}' as JSONB) <@ '{"a":"b", "b":1, "c":null}';

select cast('{"g":null}' as JSONB) <@ '{"a":"b", "b":1, "c":null}';

select cast('{"a":"c"}' as JSONB) <@ '{"a":"b", "b":1, "c":null}';

select cast('{"a":"b"}' as JSONB) <@ '{"a":"b", "b":1, "c":null}';

select cast('{"a":"b", "c":"q"}' as JSONB) <@ '{"a":"b", "b":1, "c":null}';

select cast('[5]' as JSONB) @> '[5]';

select cast('5' as JSONB) @> '5';

select cast('[5]' as JSONB) @> '5';

select cast('5' as JSONB) @> '[5]';

select cast('["9", ["7", "3"], 1]' as JSONB) @> cast('["9", ["7", "3"], 1]' as JSONB);

select cast('["9", ["7", "3"], ["1"]]' as JSONB) @> cast('["9", ["7", "3"], ["1"]]' as JSONB);

select cast('{ "name": "Bob", "tags": [ "enim", "qui"]}' as JSONB) @> '{"tags":["qu"]}';

select jsonb_array_length('[1,2,3,{"f1":1,"f2":[5,6]},4]');

select jsonb_array_length('[]');

select jsonb_array_length('{"f1":1,"f2":[5,6]}');

select jsonb_array_length('4');

select jsonb_each('{"f1":[1,2,3],"f2":{"f3":1},"f4":null}');

select
  jsonb_each(
    cast('{"a":{"b":"c","c":"b","1":"first"},"b":[1,2],"c":"cc","1":"first","n":null}'
    as JSONB)
  )
  as q;

select * from jsonb_each('{"f1":[1,2,3],"f2":{"f3":1},"f4":null,"f5":99,"f6":"stringy"}') as q;

select
  *
from
  jsonb_each(
    cast('{"a":{"b":"c","c":"b","1":"first"},"b":[1,2],"c":"cc","1":"first","n":null}'
    as JSONB)
  )
  as q;

select jsonb_each_text('{"f1":[1,2,3],"f2":{"f3":1},"f4":null,"f5":"null"}');

select
  jsonb_each_text(
    cast('{"a":{"b":"c","c":"b","1":"first"},"b":[1,2],"c":"cc","1":"first","n":null}'
    as JSONB)
  )
  as q;

select * from jsonb_each_text('{"f1":[1,2,3],"f2":{"f3":1},"f4":null,"f5":99,"f6":"stringy"}') as q;

select
  *
from
  jsonb_each_text(
    cast('{"a":{"b":"c","c":"b","1":"first"},"b":[1,2],"c":"cc","1":"first","n":null}'
    as JSONB)
  )
  as q;

select jsonb_exists('{"a":null, "b":"qq"}', 'a');

select jsonb_exists('{"a":null, "b":"qq"}', 'b');

select jsonb_exists('{"a":null, "b":"qq"}', 'c');

select jsonb_exists('{"a":"null", "b":"qq"}', 'a');

select cast('{"a":null, "b":"qq"}' as JSONB) ? 'a';

select cast('{"a":null, "b":"qq"}' as JSONB) ? 'b';

select cast('{"a":null, "b":"qq"}' as JSONB) ? 'c';

select cast('{"a":"null", "b":"qq"}' as JSONB) ? 'a';

select COUNT(*) from testjsonb where j -> 'array' ? 'bar';

select COUNT(*) from testjsonb where j -> 'array' ? cast('5' as TEXT);

select COUNT(*) from testjsonb where j -> 'array' @> cast('5' as JSONB);

select jsonb_exists_any('{"a":null, "b":"qq"}', array['a', 'b']);

select jsonb_exists_any('{"a":null, "b":"qq"}', array['b', 'a']);

select jsonb_exists_any('{"a":null, "b":"qq"}', array['c', 'a']);

select jsonb_exists_any('{"a":null, "b":"qq"}', array['c', 'd']);

select jsonb_exists_any('{"a":null, "b":"qq"}', cast('{}' as TEXT[]));

select cast('{"a":null, "b":"qq"}' as JSONB) ?| array['a', 'b'];

select cast('{"a":null, "b":"qq"}' as JSONB) ?| array['b', 'a'];

select cast('{"a":null, "b":"qq"}' as JSONB) ?| array['c', 'a'];

select cast('{"a":null, "b":"qq"}' as JSONB) ?| array['c', 'd'];

select cast('{"a":null, "b":"qq"}' as JSONB) ?| cast('{}' as TEXT[]);

select jsonb_exists_all('{"a":null, "b":"qq"}', array['a', 'b']);

select jsonb_exists_all('{"a":null, "b":"qq"}', array['b', 'a']);

select jsonb_exists_all('{"a":null, "b":"qq"}', array['c', 'a']);

select jsonb_exists_all('{"a":null, "b":"qq"}', array['c', 'd']);

select jsonb_exists_all('{"a":null, "b":"qq"}', cast('{}' as TEXT[]));

select cast('{"a":null, "b":"qq"}' as JSONB) ?& array['a', 'b'];

select cast('{"a":null, "b":"qq"}' as JSONB) ?& array['b', 'a'];

select cast('{"a":null, "b":"qq"}' as JSONB) ?& array['c', 'a'];

select cast('{"a":null, "b":"qq"}' as JSONB) ?& array['c', 'd'];

select cast('{"a":null, "b":"qq"}' as JSONB) ?& array['a', 'a', 'b', 'b', 'b'];

select cast('{"a":null, "b":"qq"}' as JSONB) ?& cast('{}' as TEXT[]);

select jsonb_typeof('{}') as object;

select jsonb_typeof('{"c":3,"p":"o"}') as object;

select jsonb_typeof('[]') as "array";

select jsonb_typeof('["a", 1]') as "array";

select jsonb_typeof('null') as "null";

select jsonb_typeof('1') as number;

select jsonb_typeof('-1') as number;

select jsonb_typeof('1.0') as number;

select jsonb_typeof('1e2') as number;

select jsonb_typeof('-1.0') as number;

select jsonb_typeof('true') as boolean;

select jsonb_typeof('false') as boolean;

select jsonb_typeof('"hello"') as string;

select jsonb_typeof('"true"') as string;

select jsonb_typeof('"1.0"') as string;

select
  jsonb_build_array(
    'a',
    1,
    'b',
    1.2,
    'c',
    true,
    'd',
    null,
    'e',
    cast('{"x": 3, "y": [1,2,3]}' as JSON)
  );

select jsonb_build_array('a', null);

select jsonb_build_array(variadic cast(null as TEXT[]));

select jsonb_build_array(variadic cast('{}' as TEXT[]));

select jsonb_build_array(variadic cast('{a,b,c}' as TEXT[]));

select jsonb_build_array(variadic cast(array['a', null] as TEXT[]));

select jsonb_build_array(variadic cast('{1,2,3,4}' as TEXT[]));

select jsonb_build_array(variadic cast('{1,2,3,4}' as INT[]));

select jsonb_build_array(variadic cast('{{1,4},{2,5},{3,6}}' as INT[][]));

select
  jsonb_build_object(
    'a',
    1,
    'b',
    1.2,
    'c',
    true,
    'd',
    null,
    'e',
    cast('{"x": 3, "y": [1,2,3]}' as JSON)
  );

select
  jsonb_build_object(
    'a',
    jsonb_build_object('b', false, 'c', 99),
    'd',
    jsonb_build_object(
      'e',
      cast(array[9, 8, 7] as INT[]),
      'f',
      (
        select
          row_to_json(r)
        from
          (
            select
              relkind,
              cast(oid as REGCLASS) as name
            from
              pg_class
            where
              relname = 'pg_class'
          )
          as r
      )
    )
  );

select jsonb_build_object(cast('{a,b,c}' as TEXT[]));

select jsonb_build_object(cast('{a,b,c}' as TEXT[]), cast('{d,e,f}' as TEXT[]));

select jsonb_build_object('a', 'b', 'c');

select jsonb_build_object(null, 'a');

select jsonb_build_object('a', null);

select jsonb_build_object(variadic cast(null as TEXT[]));

select jsonb_build_object(variadic cast('{}' as TEXT[]));

select jsonb_build_object(variadic cast('{a,b,c}' as TEXT[]));

select jsonb_build_object(variadic cast(array['a', null] as TEXT[]));

select jsonb_build_object(variadic cast(array[null, 'a'] as TEXT[]));

select jsonb_build_object(variadic cast('{1,2,3,4}' as TEXT[]));

select jsonb_build_object(variadic cast('{1,2,3,4}' as INT[]));

select jsonb_build_object(variadic cast('{{1,4},{2,5},{3,6}}' as INT[][]));

select jsonb_build_array();

select jsonb_build_object();

select jsonb_build_object(1, 2);

select jsonb_build_object(null, 2);

select jsonb_build_object(r, 2) from (select 1 as a, 2 as b) as r;

select jsonb_build_object(cast('{"a":1,"b":2}' as JSON), 3);

select jsonb_build_object(cast('{1,2,3}' as INT[]), 3);

select jsonb_object_agg(1, cast(null as JSONB));

select jsonb_object_agg(null, '{"a":1}');

create temporary table foo (
  serial_num INT,
  name TEXT,
  type TEXT
);

insert into foo values (847001, 't15', 'GE1043');

insert into foo values (847002, 't16', 'GE1043');

insert into foo values (847003, 'sub-alpha', 'GESS90');

select
  jsonb_build_object(
    'turbines',
    jsonb_object_agg(
      serial_num,
      jsonb_build_object('name', name, 'type', type)
    )
  )
from
  foo;

select jsonb_object_agg(name, type) from foo;

insert into foo values (999999, null, 'bar');

select jsonb_object_agg(name, type) from foo;

select jsonb_object_agg(distinct 'a', 'abc');

select jsonb_object('{}');

select jsonb_object('{}', '{}');

select jsonb_object('{a,1,b,2,3,NULL,"d e f","a b c"}');

select jsonb_object('{{a,1},{b,2},{3,NULL},{"d e f","a b c"}}');

select jsonb_object('{a,b,c}');

select jsonb_object('{{a},{b}}');

select jsonb_object('{{a,b,c},{b,c,d}}');

select jsonb_object('{{{a,b},{c,d}},{{b,c},{d,e}}}');

select jsonb_object('{a,b,c,"d e f"}', '{1,2,3,"a b c"}');

select
  jsonb_object(
    '{{a,1},{b,2},{3,NULL},{"d e f","a b c"}}',
    '{{a,1},{b,2},{3,NULL},{"d e f","a b c"}}'
  );

select jsonb_object('{a,b,c,"d e f",g}', '{1,2,3,"a b c"}');

select jsonb_object('{a,b,c,"d e f"}', '{1,2,3,"a b c",g}');

select jsonb_object('{a,b,NULL,"d e f"}', '{1,2,3,"a b c"}');

select jsonb_object('{a,b,"","d e f"}', '{1,2,3,"a b c"}');

select jsonb_extract_path('{"f2":{"f3":1},"f4":{"f5":99,"f6":"stringy"}}', 'f4', 'f6');

select jsonb_extract_path('{"f2":{"f3":1},"f4":{"f5":99,"f6":"stringy"}}', 'f2');

select jsonb_extract_path('{"f2":["f3",1],"f4":{"f5":99,"f6":"stringy"}}', 'f2', cast(0 as TEXT));

select jsonb_extract_path('{"f2":["f3",1],"f4":{"f5":99,"f6":"stringy"}}', 'f2', cast(1 as TEXT));

select jsonb_extract_path_text('{"f2":{"f3":1},"f4":{"f5":99,"f6":"stringy"}}', 'f4', 'f6');

select jsonb_extract_path_text('{"f2":{"f3":1},"f4":{"f5":99,"f6":"stringy"}}', 'f2');

select
  jsonb_extract_path_text(
    '{"f2":["f3",1],"f4":{"f5":99,"f6":"stringy"}}',
    'f2',
    cast(0 as TEXT)
  );

select
  jsonb_extract_path_text(
    '{"f2":["f3",1],"f4":{"f5":99,"f6":"stringy"}}',
    'f2',
    cast(1 as TEXT)
  );

select
  jsonb_extract_path(
    '{"f2":{"f3":1},"f4":{"f5":null,"f6":"stringy"}}',
    'f4',
    'f5'
  ) is null
  as expect_false;

select
  jsonb_extract_path_text(
    '{"f2":{"f3":1},"f4":{"f5":null,"f6":"stringy"}}',
    'f4',
    'f5'
  ) is null
  as expect_true;

select jsonb_extract_path('{"f2":{"f3":1},"f4":[0,1,2,null]}', 'f4', '3') is null as expect_false;

select
  jsonb_extract_path_text(
    '{"f2":{"f3":1},"f4":[0,1,2,null]}',
    'f4',
    '3'
  ) is null
  as expect_true;

select cast('{"f2":{"f3":1},"f4":{"f5":99,"f6":"stringy"}}' as JSONB) #> array['f4', 'f6'];

select cast('{"f2":{"f3":1},"f4":{"f5":99,"f6":"stringy"}}' as JSONB) #> array['f2'];

select cast('{"f2":["f3",1],"f4":{"f5":99,"f6":"stringy"}}' as JSONB) #> array['f2', '0'];

select cast('{"f2":["f3",1],"f4":{"f5":99,"f6":"stringy"}}' as JSONB) #> array['f2', '1'];

select cast('{"f2":{"f3":1},"f4":{"f5":99,"f6":"stringy"}}' as JSONB) #>> array['f4', 'f6'];

select cast('{"f2":{"f3":1},"f4":{"f5":99,"f6":"stringy"}}' as JSONB) #>> array['f2'];

select cast('{"f2":["f3",1],"f4":{"f5":99,"f6":"stringy"}}' as JSONB) #>> array['f2', '0'];

select cast('{"f2":["f3",1],"f4":{"f5":99,"f6":"stringy"}}' as JSONB) #>> array['f2', '1'];

select cast('{"a": {"b":{"c": "foo"}}}' as JSONB) #> '{}';

select cast('[1,2,3]' as JSONB) #> '{}';

select cast('"foo"' as JSONB) #> '{}';

select cast('42' as JSONB) #> '{}';

select cast('null' as JSONB) #> '{}';

select cast('{"a": {"b":{"c": "foo"}}}' as JSONB) #> array['a'];

select cast('{"a": {"b":{"c": "foo"}}}' as JSONB) #> array['a', null];

select cast('{"a": {"b":{"c": "foo"}}}' as JSONB) #> array['a', ''];

select cast('{"a": {"b":{"c": "foo"}}}' as JSONB) #> array['a', 'b'];

select cast('{"a": {"b":{"c": "foo"}}}' as JSONB) #> array['a', 'b', 'c'];

select cast('{"a": {"b":{"c": "foo"}}}' as JSONB) #> array['a', 'b', 'c', 'd'];

select cast('{"a": {"b":{"c": "foo"}}}' as JSONB) #> array['a', 'z', 'c'];

select cast('{"a": [{"b": "c"}, {"b": "cc"}]}' as JSONB) #> array['a', '1', 'b'];

select cast('{"a": [{"b": "c"}, {"b": "cc"}]}' as JSONB) #> array['a', 'z', 'b'];

select cast('[{"b": "c"}, {"b": "cc"}]' as JSONB) #> array['1', 'b'];

select cast('[{"b": "c"}, {"b": "cc"}]' as JSONB) #> array['z', 'b'];

select cast('[{"b": "c"}, {"b": null}]' as JSONB) #> array['1', 'b'];

select cast('"foo"' as JSONB) #> array['z'];

select cast('42' as JSONB) #> array['f2'];

select cast('42' as JSONB) #> array['0'];

select cast('{"a": {"b":{"c": "foo"}}}' as JSONB) #>> '{}';

select cast('[1,2,3]' as JSONB) #>> '{}';

select cast('"foo"' as JSONB) #>> '{}';

select cast('42' as JSONB) #>> '{}';

select cast('null' as JSONB) #>> '{}';

select cast('{"a": {"b":{"c": "foo"}}}' as JSONB) #>> array['a'];

select cast('{"a": {"b":{"c": "foo"}}}' as JSONB) #>> array['a', null];

select cast('{"a": {"b":{"c": "foo"}}}' as JSONB) #>> array['a', ''];

select cast('{"a": {"b":{"c": "foo"}}}' as JSONB) #>> array['a', 'b'];

select cast('{"a": {"b":{"c": "foo"}}}' as JSONB) #>> array['a', 'b', 'c'];

select cast('{"a": {"b":{"c": "foo"}}}' as JSONB) #>> array['a', 'b', 'c', 'd'];

select cast('{"a": {"b":{"c": "foo"}}}' as JSONB) #>> array['a', 'z', 'c'];

select cast('{"a": [{"b": "c"}, {"b": "cc"}]}' as JSONB) #>> array['a', '1', 'b'];

select cast('{"a": [{"b": "c"}, {"b": "cc"}]}' as JSONB) #>> array['a', 'z', 'b'];

select cast('[{"b": "c"}, {"b": "cc"}]' as JSONB) #>> array['1', 'b'];

select cast('[{"b": "c"}, {"b": "cc"}]' as JSONB) #>> array['z', 'b'];

select cast('[{"b": "c"}, {"b": null}]' as JSONB) #>> array['1', 'b'];

select cast('"foo"' as JSONB) #>> array['z'];

select cast('42' as JSONB) #>> array['f2'];

select cast('42' as JSONB) #>> array['0'];

select jsonb_array_elements('[1,true,[1,[2,3]],null,{"f1":1,"f2":[7,8,9]},false]');

select * from jsonb_array_elements('[1,true,[1,[2,3]],null,{"f1":1,"f2":[7,8,9]},false]') as q;

select jsonb_array_elements_text('[1,true,[1,[2,3]],null,{"f1":1,"f2":[7,8,9]},false,"stringy"]');

select
  *
from
  jsonb_array_elements_text(
    '[1,true,[1,[2,3]],null,{"f1":1,"f2":[7,8,9]},false,"stringy"]'
  )
  as q;

create type jbpop as (a TEXT, b INT, c TIMESTAMP);

create domain jsb_int_not_null as INT not null;

create domain jsb_int_array_1d as INT[] check (array_length(value, 1) = 3);

create domain jsb_int_array_2d as INT[][] check (array_length(value, 2) = 3);

create type jb_unordered_pair as (x INT, y INT);

create domain jb_ordered_pair as jb_unordered_pair check (value.x <= value.y);

create type jsbrec as (
  i INT,
  ia _int4,
  ia1 INT[],
  ia2 INT[][],
  ia3 INT[][][],
  ia1d jsb_int_array_1d,
  ia2d jsb_int_array_2d,
  t TEXT,
  ta TEXT[],
  c CHAR(10),
  ca CHAR(10)[],
  ts TIMESTAMP,
  js JSON,
  jsb JSONB,
  jsa JSON[],
  rec jbpop,
  reca jbpop[]
);

create type jsbrec_i_not_null as (i jsb_int_not_null);

select * from jsonb_populate_record(cast(null as jbpop), '{"a":"blurfl","x":43.2}') as q;

select
  *
from
  jsonb_populate_record(
    cast(row('x', 3, '2012-12-31 15:30:56') as jbpop),
    '{"a":"blurfl","x":43.2}'
  )
  as q;

select * from jsonb_populate_record(cast(null as jbpop), '{"a":"blurfl","x":43.2}') as q;

select
  *
from
  jsonb_populate_record(
    cast(row('x', 3, '2012-12-31 15:30:56') as jbpop),
    '{"a":"blurfl","x":43.2}'
  )
  as q;

select * from jsonb_populate_record(cast(null as jbpop), '{"a":[100,200,false],"x":43.2}') as q;

select
  *
from
  jsonb_populate_record(
    cast(row('x', 3, '2012-12-31 15:30:56') as jbpop),
    '{"a":[100,200,false],"x":43.2}'
  )
  as q;

select
  *
from
  jsonb_populate_record(
    cast(row('x', 3, '2012-12-31 15:30:56') as jbpop),
    '{"c":[100,200,false],"x":43.2}'
  )
  as q;

select * from jsonb_populate_record(cast(row('x', 3, '2012-12-31 15:30:56') as jbpop), '{}') as q;

select i from jsonb_populate_record(cast(null as jsbrec_i_not_null), '{"x": 43.2}') as q;

select i from jsonb_populate_record(cast(null as jsbrec_i_not_null), '{"i": null}') as q;

select i from jsonb_populate_record(cast(null as jsbrec_i_not_null), '{"i": 12345}') as q;

select ia from jsonb_populate_record(cast(null as jsbrec), '{"ia": null}') as q;

select ia from jsonb_populate_record(cast(null as jsbrec), '{"ia": 123}') as q;

select ia from jsonb_populate_record(cast(null as jsbrec), '{"ia": [1, "2", null, 4]}') as q;

select ia from jsonb_populate_record(cast(null as jsbrec), '{"ia": [[1, 2], [3, 4]]}') as q;

select ia from jsonb_populate_record(cast(null as jsbrec), '{"ia": [[1], 2]}') as q;

select ia from jsonb_populate_record(cast(null as jsbrec), '{"ia": [[1], [2, 3]]}') as q;

select ia from jsonb_populate_record(cast(null as jsbrec), '{"ia": "{1,2,3}"}') as q;

select ia1 from jsonb_populate_record(cast(null as jsbrec), '{"ia1": null}') as q;

select ia1 from jsonb_populate_record(cast(null as jsbrec), '{"ia1": 123}') as q;

select ia1 from jsonb_populate_record(cast(null as jsbrec), '{"ia1": [1, "2", null, 4]}') as q;

select ia1 from jsonb_populate_record(cast(null as jsbrec), '{"ia1": [[1, 2, 3]]}') as q;

select ia1d from jsonb_populate_record(cast(null as jsbrec), '{"ia1d": null}') as q;

select ia1d from jsonb_populate_record(cast(null as jsbrec), '{"ia1d": 123}') as q;

select ia1d from jsonb_populate_record(cast(null as jsbrec), '{"ia1d": [1, "2", null, 4]}') as q;

select ia1d from jsonb_populate_record(cast(null as jsbrec), '{"ia1d": [1, "2", null]}') as q;

select ia2 from jsonb_populate_record(cast(null as jsbrec), '{"ia2": [1, "2", null, 4]}') as q;

select ia2 from jsonb_populate_record(cast(null as jsbrec), '{"ia2": [[1, 2], [null, 4]]}') as q;

select ia2 from jsonb_populate_record(cast(null as jsbrec), '{"ia2": [[], []]}') as q;

select ia2 from jsonb_populate_record(cast(null as jsbrec), '{"ia2": [[1, 2], [3]]}') as q;

select ia2 from jsonb_populate_record(cast(null as jsbrec), '{"ia2": [[1, 2], 3, 4]}') as q;

select
  ia2d
from
  jsonb_populate_record(
    cast(null as jsbrec),
    '{"ia2d": [[1, "2"], [null, 4]]}'
  )
  as q;

select
  ia2d
from
  jsonb_populate_record(
    cast(null as jsbrec),
    '{"ia2d": [[1, "2", 3], [null, 5, 6]]}'
  )
  as q;

select ia3 from jsonb_populate_record(cast(null as jsbrec), '{"ia3": [1, "2", null, 4]}') as q;

select ia3 from jsonb_populate_record(cast(null as jsbrec), '{"ia3": [[1, 2], [null, 4]]}') as q;

select
  ia3
from
  jsonb_populate_record(
    cast(null as jsbrec),
    '{"ia3": [ [[], []], [[], []], [[], []] ]}'
  )
  as q;

select ia3 from jsonb_populate_record(cast(null as jsbrec), '{"ia3": [ [[1, 2]], [[3, 4]] ]}') as q;

select
  ia3
from
  jsonb_populate_record(
    cast(null as jsbrec),
    '{"ia3": [ [[1, 2], [3, 4]], [[5, 6], [7, 8]] ]}'
  )
  as q;

select
  ia3
from
  jsonb_populate_record(
    cast(null as jsbrec),
    '{"ia3": [ [[1, 2], [3, 4]], [[5, 6], [7, 8], [9, 10]] ]}'
  )
  as q;

select ta from jsonb_populate_record(cast(null as jsbrec), '{"ta": null}') as q;

select ta from jsonb_populate_record(cast(null as jsbrec), '{"ta": 123}') as q;

select ta from jsonb_populate_record(cast(null as jsbrec), '{"ta": [1, "2", null, 4]}') as q;

select ta from jsonb_populate_record(cast(null as jsbrec), '{"ta": [[1, 2, 3], {"k": "v"}]}') as q;

select c from jsonb_populate_record(cast(null as jsbrec), '{"c": null}') as q;

select c from jsonb_populate_record(cast(null as jsbrec), '{"c": "aaa"}') as q;

select c from jsonb_populate_record(cast(null as jsbrec), '{"c": "aaaaaaaaaa"}') as q;

select c from jsonb_populate_record(cast(null as jsbrec), '{"c": "aaaaaaaaaaaaa"}') as q;

select ca from jsonb_populate_record(cast(null as jsbrec), '{"ca": null}') as q;

select ca from jsonb_populate_record(cast(null as jsbrec), '{"ca": 123}') as q;

select ca from jsonb_populate_record(cast(null as jsbrec), '{"ca": [1, "2", null, 4]}') as q;

select ca from jsonb_populate_record(cast(null as jsbrec), '{"ca": ["aaaaaaaaaaaaaaaa"]}') as q;

select ca from jsonb_populate_record(cast(null as jsbrec), '{"ca": [[1, 2, 3], {"k": "v"}]}') as q;

select js from jsonb_populate_record(cast(null as jsbrec), '{"js": null}') as q;

select js from jsonb_populate_record(cast(null as jsbrec), '{"js": true}') as q;

select js from jsonb_populate_record(cast(null as jsbrec), '{"js": 123.45}') as q;

select js from jsonb_populate_record(cast(null as jsbrec), '{"js": "123.45"}') as q;

select js from jsonb_populate_record(cast(null as jsbrec), '{"js": "abc"}') as q;

select
  js
from
  jsonb_populate_record(
    cast(null as jsbrec),
    '{"js": [123, "123", null, {"key": "value"}]}'
  )
  as q;

select
  js
from
  jsonb_populate_record(
    cast(null as jsbrec),
    '{"js": {"a": "bbb", "b": null, "c": 123.45}}'
  )
  as q;

select jsb from jsonb_populate_record(cast(null as jsbrec), '{"jsb": null}') as q;

select jsb from jsonb_populate_record(cast(null as jsbrec), '{"jsb": true}') as q;

select jsb from jsonb_populate_record(cast(null as jsbrec), '{"jsb": 123.45}') as q;

select jsb from jsonb_populate_record(cast(null as jsbrec), '{"jsb": "123.45"}') as q;

select jsb from jsonb_populate_record(cast(null as jsbrec), '{"jsb": "abc"}') as q;

select
  jsb
from
  jsonb_populate_record(
    cast(null as jsbrec),
    '{"jsb": [123, "123", null, {"key": "value"}]}'
  )
  as q;

select
  jsb
from
  jsonb_populate_record(
    cast(null as jsbrec),
    '{"jsb": {"a": "bbb", "b": null, "c": 123.45}}'
  )
  as q;

select jsa from jsonb_populate_record(cast(null as jsbrec), '{"jsa": null}') as q;

select jsa from jsonb_populate_record(cast(null as jsbrec), '{"jsa": 123}') as q;

select jsa from jsonb_populate_record(cast(null as jsbrec), '{"jsa": [1, "2", null, 4]}') as q;

select
  jsa
from
  jsonb_populate_record(
    cast(null as jsbrec),
    '{"jsa": ["aaa", null, [1, 2, "3", {}], { "k" : "v" }]}'
  )
  as q;

select rec from jsonb_populate_record(cast(null as jsbrec), '{"rec": 123}') as q;

select rec from jsonb_populate_record(cast(null as jsbrec), '{"rec": [1, 2]}') as q;

select
  rec
from
  jsonb_populate_record(
    cast(null as jsbrec),
    '{"rec": {"a": "abc", "c": "01.02.2003", "x": 43.2}}'
  )
  as q;

select rec from jsonb_populate_record(cast(null as jsbrec), '{"rec": "(abc,42,01.02.2003)"}') as q;

select reca from jsonb_populate_record(cast(null as jsbrec), '{"reca": 123}') as q;

select reca from jsonb_populate_record(cast(null as jsbrec), '{"reca": [1, 2]}') as q;

select
  reca
from
  jsonb_populate_record(
    cast(null as jsbrec),
    '{"reca": [{"a": "abc", "b": 456}, null, {"c": "01.02.2003", "x": 43.2}]}'
  )
  as q;

select
  reca
from
  jsonb_populate_record(
    cast(null as jsbrec),
    '{"reca": ["(abc,42,01.02.2003)"]}'
  )
  as q;

select
  reca
from
  jsonb_populate_record(
    cast(null as jsbrec),
    '{"reca": "{\"(abc,42,01.02.2003)\"}"}'
  )
  as q;

select
  rec
from
  jsonb_populate_record(
    cast(row(null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    cast(row('x', 3, '2012-12-31 15:30:56') as jbpop),
    null)
    as jsbrec),
    '{"rec": {"a": "abc", "c": "01.02.2003", "x": 43.2}}'
  )
  as q;

create type jsb_char2 as (a CHAR(2));

select jsonb_populate_record_valid(cast(null as jsb_char2), '{"a": "aaa"}');

select * from jsonb_populate_record(cast(null as jsb_char2), '{"a": "aaa"}') as q;

select jsonb_populate_record_valid(cast(null as jsb_char2), '{"a": "aa"}');

select * from jsonb_populate_record(cast(null as jsb_char2), '{"a": "aa"}') as q;

create type jsb_ia as (a INT[]);

create type jsb_ia2 as (a INT[][]);

select jsonb_populate_record_valid(cast(null as jsb_ia), '{"a": 43.2}');

select * from jsonb_populate_record(cast(null as jsb_ia), '{"a": 43.2}') as q;

select jsonb_populate_record_valid(cast(null as jsb_ia), '{"a": [1, 2]}');

select * from jsonb_populate_record(cast(null as jsb_ia), '{"a": [1, 2]}') as q;

select jsonb_populate_record_valid(cast(null as jsb_ia2), '{"a": [[1], [2, 3]]}');

select * from jsonb_populate_record(cast(null as jsb_ia2), '{"a": [[1], [2, 3]]}') as q;

select jsonb_populate_record_valid(cast(null as jsb_ia2), '{"a": [[1, 0], [2, 3]]}');

select * from jsonb_populate_record(cast(null as jsb_ia2), '{"a": [[1, 0], [2, 3]]}') as q;

create domain jsb_i_not_null as INT not null;

create domain jsb_i_gt_1 as INT check (value > 1);

create type jsb_i_not_null_rec as (a jsb_i_not_null);

create type jsb_i_gt_1_rec as (a jsb_i_gt_1);

select jsonb_populate_record_valid(cast(null as jsb_i_not_null_rec), '{"a": null}');

select * from jsonb_populate_record(cast(null as jsb_i_not_null_rec), '{"a": null}') as q;

select jsonb_populate_record_valid(cast(null as jsb_i_not_null_rec), '{"a": 1}');

select * from jsonb_populate_record(cast(null as jsb_i_not_null_rec), '{"a": 1}') as q;

select jsonb_populate_record_valid(cast(null as jsb_i_gt_1_rec), '{"a": 1}');

select * from jsonb_populate_record(cast(null as jsb_i_gt_1_rec), '{"a": 1}') as q;

select jsonb_populate_record_valid(cast(null as jsb_i_gt_1_rec), '{"a": 2}');

select * from jsonb_populate_record(cast(null as jsb_i_gt_1_rec), '{"a": 2}') as q;

drop TYPE jsb_ia, jsb_ia2, jsb_char2, jsb_i_not_null_rec, jsb_i_gt_1_rec;

drop DOMAIN jsb_i_not_null, jsb_i_gt_1;

select jsonb_populate_record(cast(null as RECORD), '{"x": 0, "y": 1}');

select jsonb_populate_record(row(1, 2), '{"f1": 0, "f2": 1}');

select * from jsonb_populate_record(cast(null as RECORD), '{"x": 776}') as (x INT, y INT);

select jsonb_populate_record(cast(null as jb_ordered_pair), '{"x": 0, "y": 1}');

select jsonb_populate_record(cast(row(1, 2) as jb_ordered_pair), '{"x": 0}');

select jsonb_populate_record(cast(row(1, 2) as jb_ordered_pair), '{"x": 1, "y": 0}');

select
  *
from
  jsonb_populate_recordset(
    cast(null as jbpop),
    '[{"a":"blurfl","x":43.2},{"b":3,"c":"2012-01-20 10:42:53"}]'
  )
  as q;

select
  *
from
  jsonb_populate_recordset(
    cast(row('def', 99, null) as jbpop),
    '[{"a":"blurfl","x":43.2},{"b":3,"c":"2012-01-20 10:42:53"}]'
  )
  as q;

select
  *
from
  jsonb_populate_recordset(
    cast(null as jbpop),
    '[{"a":"blurfl","x":43.2},{"b":3,"c":"2012-01-20 10:42:53"}]'
  )
  as q;

select
  *
from
  jsonb_populate_recordset(
    cast(row('def', 99, null) as jbpop),
    '[{"a":"blurfl","x":43.2},{"b":3,"c":"2012-01-20 10:42:53"}]'
  )
  as q;

select
  *
from
  jsonb_populate_recordset(
    cast(row('def', 99, null) as jbpop),
    '[{"a":[100,200,300],"x":43.2},{"a":{"z":true},"b":3,"c":"2012-01-20 10:42:53"}]'
  )
  as q;

select
  *
from
  jsonb_populate_recordset(
    cast(row('def', 99, null) as jbpop),
    '[{"c":[100,200,300],"x":43.2},{"a":{"z":true},"b":3,"c":"2012-01-20 10:42:53"}]'
  )
  as q;

select
  *
from
  jsonb_populate_recordset(
    cast(null as jbpop),
    '[{"a":"blurfl","x":43.2},{"b":3,"c":"2012-01-20 10:42:53"}]'
  )
  as q;

select
  *
from
  jsonb_populate_recordset(
    cast(row('def', 99, null) as jbpop),
    '[{"a":"blurfl","x":43.2},{"b":3,"c":"2012-01-20 10:42:53"}]'
  )
  as q;

select
  *
from
  jsonb_populate_recordset(
    cast(row('def', 99, null) as jbpop),
    '[{"a":[100,200,300],"x":43.2},{"a":{"z":true},"b":3,"c":"2012-01-20 10:42:53"}]'
  )
  as q;

select jsonb_populate_recordset(cast(null as RECORD), '[{"x": 0, "y": 1}]');

select jsonb_populate_recordset(row(1, 2), '[{"f1": 0, "f2": 1}]');

select
  i,
  jsonb_populate_recordset(
    row(i, 50),
    '[{"f1":"42"},{"f2":"43"}]'
  )
from
  (values (1), (2)) as v (i);

select * from jsonb_populate_recordset(cast(null as RECORD), '[{"x": 776}]') as (x INT, y INT);

select jsonb_populate_recordset(cast(null as RECORD), '[]');

select jsonb_populate_recordset(row(1, 2), '[]');

select * from jsonb_populate_recordset(cast(null as jbpop), '[]') as q;

select * from jsonb_populate_recordset(cast(null as RECORD), '[]') as (x INT, y INT);

select jsonb_populate_recordset(cast(null as jb_ordered_pair), '[{"x": 0, "y": 1}]');

select jsonb_populate_recordset(cast(row(1, 2) as jb_ordered_pair), '[{"x": 0}, {"y": 3}]');

select jsonb_populate_recordset(cast(row(1, 2) as jb_ordered_pair), '[{"x": 1, "y": 0}]');

select
  *
from
  jsonb_populate_recordset(
    row(cast(0 as INT)),
    '[{"a":"1","b":"2"},{"a":"3"}]'
  )
  as q
  (a TEXT, b TEXT);

select
  *
from
  jsonb_populate_recordset(
    row(cast(0 as INT), cast(0 as INT)),
    '[{"a":"1","b":"2"},{"a":"3"}]'
  )
  as q
  (a TEXT, b TEXT);

select
  *
from
  jsonb_populate_recordset(
    row(cast(0 as INT),
    cast(0 as INT),
    cast(0 as INT)),
    '[{"a":"1","b":"2"},{"a":"3"}]'
  )
  as q
  (a TEXT, b TEXT);

select
  *
from
  jsonb_populate_recordset(
    row(cast(1000000000 as INT), cast(50 as INT)),
    '[{"b":"2"},{"a":"3"}]'
  )
  as q
  (a TEXT, b TEXT);

select * from jsonb_to_record('{"a":1,"b":"foo","c":"bar"}') as x (a INT, b TEXT, d TEXT);

select
  *
from
  jsonb_to_recordset(
    '[{"a":1,"b":"foo","d":false},{"a":2,"b":"bar","c":true}]'
  )
  as x
  (a INT, b TEXT, c BOOLEAN);

select
  *,
  c is null as c_is_null
from
  jsonb_to_record(
    cast('{"a":1, "b":{"c":16, "d":2}, "x":8, "ca": ["1 2", 3], "ia": [[1,2],[3,4]], "r": {"a": "aaa", "b": 123}}'
    as JSONB)
  )
  as t
  (
    a INT,
    b JSONB,
    c TEXT,
    x INT,
    ca CHAR(5)[],
    ia INT[][],
    r jbpop
  );

select
  *,
  c is null as c_is_null
from
  jsonb_to_recordset(
    cast('[{"a":1, "b":{"c":16, "d":2}, "x":8}]'
    as JSONB)
  )
  as t
  (a INT, b JSONB, c TEXT, x INT);

select * from jsonb_to_record('{"ia": null}') as x (ia _int4);

select * from jsonb_to_record('{"ia": 123}') as x (ia _int4);

select * from jsonb_to_record('{"ia": [1, "2", null, 4]}') as x (ia _int4);

select * from jsonb_to_record('{"ia": [[1, 2], [3, 4]]}') as x (ia _int4);

select * from jsonb_to_record('{"ia": [[1], 2]}') as x (ia _int4);

select * from jsonb_to_record('{"ia": [[1], [2, 3]]}') as x (ia _int4);

select * from jsonb_to_record('{"ia2": [1, 2, 3]}') as x (ia2 INT[][]);

select * from jsonb_to_record('{"ia2": [[1, 2], [3, 4]]}') as x (ia2 INT[][]);

select * from jsonb_to_record('{"ia2": [[[1], [2], [3]]]}') as x (ia2 INT[][]);

select * from jsonb_to_record('{"out": {"key": 1}}') as x (out JSON);

select * from jsonb_to_record('{"out": [{"key": 1}]}') as x (out JSON);

select * from jsonb_to_record('{"out": "{\"key\": 1}"}') as x (out JSON);

select * from jsonb_to_record('{"out": {"key": 1}}') as x (out JSONB);

select * from jsonb_to_record('{"out": [{"key": 1}]}') as x (out JSONB);

select * from jsonb_to_record('{"out": "{\"key\": 1}"}') as x (out JSONB);

create temporary table jsbpoptest (js JSONB);

insert into jsbpoptest
select
  cast('{
	"jsa": [1, "2", null, 4],
	"rec": {"a": "abc", "c": "01.02.2003", "x": 43.2},
	"reca": [{"a": "abc", "b": 456}, null, {"c": "01.02.2003", "x": 43.2}]
}'
  as JSONB)
from
  generate_series(1, 3);

select (jsonb_populate_record(cast(null as jsbrec), js)).* from jsbpoptest;

drop TYPE jsbrec;

drop TYPE jsbrec_i_not_null;

drop DOMAIN jsb_int_not_null;

drop DOMAIN jsb_int_array_1d;

drop DOMAIN jsb_int_array_2d;

drop DOMAIN jb_ordered_pair;

drop TYPE jb_unordered_pair;

select COUNT(*) from testjsonb where j @> '{"wait":null}';

select COUNT(*) from testjsonb where j @> '{"wait":"CC"}';

select COUNT(*) from testjsonb where j @> '{"wait":"CC", "public":true}';

select COUNT(*) from testjsonb where j @> '{"age":25}';

select COUNT(*) from testjsonb where j @> '{"age":25.0}';

select COUNT(*) from testjsonb where j ? 'public';

select COUNT(*) from testjsonb where j ? 'bar';

select COUNT(*) from testjsonb where j ?| array['public', 'disabled'];

select COUNT(*) from testjsonb where j ?& array['public', 'disabled'];

select COUNT(*) from testjsonb where j @@ '$.wait == null';

select COUNT(*) from testjsonb where j @@ '"CC" == $.wait';

select COUNT(*) from testjsonb where j @@ '$.wait == "CC" && true == $.public';

select COUNT(*) from testjsonb where j @@ '$.age == 25';

select COUNT(*) from testjsonb where j @@ '$.age == 25.0';

select COUNT(*) from testjsonb where j @@ 'exists($)';

select COUNT(*) from testjsonb where j @@ 'exists($.public)';

select COUNT(*) from testjsonb where j @@ 'exists($.bar)';

select COUNT(*) from testjsonb where j @@ 'exists($.public) || exists($.disabled)';

select COUNT(*) from testjsonb where j @@ 'exists($.public) && exists($.disabled)';

select COUNT(*) from testjsonb where j @? '$.wait ? (@ == null)';

select COUNT(*) from testjsonb where j @? '$.wait ? ("CC" == @)';

select COUNT(*) from testjsonb where j @? '$ ? (@.wait == "CC" && true == @.public)';

select COUNT(*) from testjsonb where j @? '$.age ? (@ == 25)';

select COUNT(*) from testjsonb where j @? '$ ? (@.age == 25.0)';

select COUNT(*) from testjsonb where j @? '$';

select COUNT(*) from testjsonb where j @? '$.public';

select COUNT(*) from testjsonb where j @? '$.bar';

create index "jidx" on testjsonb using gin (j);

set enable_seqscan = off;

select COUNT(*) from testjsonb where j @> '{"wait":null}';

select COUNT(*) from testjsonb where j @> '{"wait":"CC"}';

select COUNT(*) from testjsonb where j @> '{"wait":"CC", "public":true}';

select COUNT(*) from testjsonb where j @> '{"age":25}';

select COUNT(*) from testjsonb where j @> '{"age":25.0}';

select COUNT(*) from testjsonb where j @> '{"array":["foo"]}';

select COUNT(*) from testjsonb where j @> '{"array":["bar"]}';

select COUNT(*) from testjsonb where j @> '{}';

select COUNT(*) from testjsonb where j ? 'public';

select COUNT(*) from testjsonb where j ? 'bar';

select COUNT(*) from testjsonb where j ?| array['public', 'disabled'];

select COUNT(*) from testjsonb where j ?& array['public', 'disabled'];

select COUNT(*) from testjsonb where j @@ '$.wait == null';

select COUNT(*) from testjsonb where j @@ '$.wait == null';

select COUNT(*) from testjsonb where j @@ 'exists($ ? (@.wait == null))';

select COUNT(*) from testjsonb where j @@ 'exists($.wait ? (@ == null))';

select COUNT(*) from testjsonb where j @@ '"CC" == $.wait';

select COUNT(*) from testjsonb where j @@ '$.wait == "CC" && true == $.public';

select COUNT(*) from testjsonb where j @@ '$.age == 25';

select COUNT(*) from testjsonb where j @@ '$.age == 25.0';

select COUNT(*) from testjsonb where j @@ '$.array[*] == "foo"';

select COUNT(*) from testjsonb where j @@ '$.array[*] == "bar"';

select COUNT(*) from testjsonb where j @@ 'exists($ ? (@.array[*] == "bar"))';

select COUNT(*) from testjsonb where j @@ 'exists($.array ? (@[*] == "bar"))';

select COUNT(*) from testjsonb where j @@ 'exists($.array[*] ? (@ == "bar"))';

select COUNT(*) from testjsonb where j @@ 'exists($)';

select COUNT(*) from testjsonb where j @@ 'exists($.public)';

select COUNT(*) from testjsonb where j @@ 'exists($.bar)';

select COUNT(*) from testjsonb where j @@ 'exists($.public) || exists($.disabled)';

select COUNT(*) from testjsonb where j @@ 'exists($.public) && exists($.disabled)';

select COUNT(*) from testjsonb where j @? '$.wait ? (@ == null)';

select COUNT(*) from testjsonb where j @? '$.wait ? (@ == null)';

select COUNT(*) from testjsonb where j @? '$.wait ? ("CC" == @)';

select COUNT(*) from testjsonb where j @? '$ ? (@.wait == "CC" && true == @.public)';

select COUNT(*) from testjsonb where j @? '$.age ? (@ == 25)';

select COUNT(*) from testjsonb where j @? '$ ? (@.age == 25.0)';

select COUNT(*) from testjsonb where j @? '$ ? (@.array[*] == "bar")';

select COUNT(*) from testjsonb where j @? '$.array ? (@[*] == "bar")';

select COUNT(*) from testjsonb where j @? '$.array[*] ? (@ == "bar")';

select COUNT(*) from testjsonb where j @? '$';

select COUNT(*) from testjsonb where j @? '$.public';

select COUNT(*) from testjsonb where j @? '$.bar';

create index "jidx_array" on testjsonb using gin ((j -> 'array'));

select COUNT(*) from testjsonb where j -> 'array' ? 'bar';

select COUNT(*) from testjsonb where j -> 'array' ? cast('5' as TEXT);

select COUNT(*) from testjsonb where j -> 'array' @> cast('5' as JSONB);

reset enable_seqscan;

select COUNT(*) from (select (jsonb_each(j)).key from testjsonb) as wow;

select
  key,
  COUNT(*)
from
  (select (jsonb_each(j)).key from testjsonb) as wow
group by key
order by count desc,
  key;

select COUNT(distinct j) from testjsonb;

set enable_hashagg = off;

select
  COUNT(*)
from
  (
    select
      j
    from
      (
        select * from testjsonb
        union all
        select * from testjsonb
      )
      as js
    group by j
  )
  as js2;

set enable_hashagg = 'on';

set enable_sort = off;

select
  COUNT(*)
from
  (
    select
      j
    from
      (
        select * from testjsonb
        union all
        select * from testjsonb
      )
      as js
    group by j
  )
  as js2;

select distinct * from (values (cast('{}' as JSONB) || cast('' as TEXT)), ('{}')) as v (j);

set enable_sort = 'on';

reset enable_hashagg;

reset enable_sort;

drop INDEX jidx;

drop INDEX jidx_array;

create index "jidx" on testjsonb using btree (j);

set enable_seqscan = off;

select COUNT(*) from testjsonb where j > '{"p":1}';

select COUNT(*) from testjsonb where j = '{"pos":98, "line":371, "node":"CBA", "indexed":true}';

drop INDEX jidx;

create index "jidx" on testjsonb using gin (j jsonb_path_ops);

set enable_seqscan = off;

select COUNT(*) from testjsonb where j @> '{"wait":null}';

select COUNT(*) from testjsonb where j @> '{"wait":"CC"}';

select COUNT(*) from testjsonb where j @> '{"wait":"CC", "public":true}';

select COUNT(*) from testjsonb where j @> '{"age":25}';

select COUNT(*) from testjsonb where j @> '{"age":25.0}';

select COUNT(*) from testjsonb where j @> '{}';

select COUNT(*) from testjsonb where j @@ '$.wait == null';

select COUNT(*) from testjsonb where j @@ 'exists($ ? (@.wait == null))';

select COUNT(*) from testjsonb where j @@ 'exists($.wait ? (@ == null))';

select COUNT(*) from testjsonb where j @@ '"CC" == $.wait';

select COUNT(*) from testjsonb where j @@ '$.wait == "CC" && true == $.public';

select COUNT(*) from testjsonb where j @@ '$.age == 25';

select COUNT(*) from testjsonb where j @@ '$.age == 25.0';

select COUNT(*) from testjsonb where j @@ '$.array[*] == "foo"';

select COUNT(*) from testjsonb where j @@ '$.array[*] == "bar"';

select COUNT(*) from testjsonb where j @@ 'exists($ ? (@.array[*] == "bar"))';

select COUNT(*) from testjsonb where j @@ 'exists($.array ? (@[*] == "bar"))';

select COUNT(*) from testjsonb where j @@ 'exists($.array[*] ? (@ == "bar"))';

select COUNT(*) from testjsonb where j @@ 'exists($)';

select COUNT(*) from testjsonb where j @? '$.wait ? (@ == null)';

select COUNT(*) from testjsonb where j @? '$.wait ? (@ == null)';

select COUNT(*) from testjsonb where j @? '$.wait ? ("CC" == @)';

select COUNT(*) from testjsonb where j @? '$ ? (@.wait == "CC" && true == @.public)';

select COUNT(*) from testjsonb where j @? '$.age ? (@ == 25)';

select COUNT(*) from testjsonb where j @? '$ ? (@.age == 25.0)';

select COUNT(*) from testjsonb where j @? '$ ? (@.array[*] == "bar")';

select COUNT(*) from testjsonb where j @? '$.array ? (@[*] == "bar")';

select COUNT(*) from testjsonb where j @? '$.array[*] ? (@ == "bar")';

select COUNT(*) from testjsonb where j @? '$';

select COUNT(*) from testjsonb where j @? '$.public';

select COUNT(*) from testjsonb where j @? '$.bar';

reset enable_seqscan;

drop INDEX jidx;

select cast('{"ff":{"a":12,"b":16}}' as JSONB);

select cast('{"ff":{"a":12,"b":16},"qq":123}' as JSONB);

select
  cast('{"aa":["a","aaa"],"qq":{"a":12,"b":16,"c":["c1","c2"],"d":{"d1":"d1","d2":"d2","d1":"d3"}}}'
  as JSONB);

select
  cast('{"aa":["a","aaa"],"qq":{"a":"12","b":"16","c":["c1","c2"],"d":{"d1":"d1","d2":"d2"}}}'
  as JSONB);

select
  cast('{"aa":["a","aaa"],"qq":{"a":"12","b":"16","c":["c1","c2",["c3"],{"c4":4}],"d":{"d1":"d1","d2":"d2"}}}'
  as JSONB);

select cast('{"ff":["a","aaa"]}' as JSONB);

select
  cast('{"ff":{"a":12,"b":16},"qq":123,"x":[1,2],"Y":null}'
  as JSONB) ->
  'ff',
  cast('{"ff":{"a":12,"b":16},"qq":123,"x":[1,2],"Y":null}'
  as JSONB) ->
  'qq',
  cast('{"ff":{"a":12,"b":16},"qq":123,"x":[1,2],"Y":null}'
  as JSONB) ->
  'Y' is null
  as f,
  cast('{"ff":{"a":12,"b":16},"qq":123,"x":[1,2],"Y":null}'
  as JSONB) ->>
  'Y' is null
  as t,
  cast('{"ff":{"a":12,"b":16},"qq":123,"x":[1,2],"Y":null}'
  as JSONB) ->
  'x';

select cast('{"a":[1,2],"c":"b"}' as JSONB) @> '{"a":[1,2]}';

select cast('{"a":[2,1],"c":"b"}' as JSONB) @> '{"a":[1,2]}';

select cast('{"a":{"1":2},"c":"b"}' as JSONB) @> '{"a":[1,2]}';

select cast('{"a":{"2":1},"c":"b"}' as JSONB) @> '{"a":[1,2]}';

select cast('{"a":{"1":2},"c":"b"}' as JSONB) @> '{"a":{"1":2}}';

select cast('{"a":{"2":1},"c":"b"}' as JSONB) @> '{"a":{"1":2}}';

select cast('["a","b"]' as JSONB) @> '["a","b","c","b"]';

select cast('["a","b","c","b"]' as JSONB) @> '["a","b"]';

select cast('["a","b","c",[1,2]]' as JSONB) @> '["a",[1,2]]';

select cast('["a","b","c",[1,2]]' as JSONB) @> '["b",[1,2]]';

select cast('{"a":[1,2],"c":"b"}' as JSONB) @> '{"a":[1]}';

select cast('{"a":[1,2],"c":"b"}' as JSONB) @> '{"a":[2]}';

select cast('{"a":[1,2],"c":"b"}' as JSONB) @> '{"a":[3]}';

select cast('{"a":[1,2,{"c":3,"x":4}],"c":"b"}' as JSONB) @> '{"a":[{"c":3}]}';

select cast('{"a":[1,2,{"c":3,"x":4}],"c":"b"}' as JSONB) @> '{"a":[{"x":4}]}';

select cast('{"a":[1,2,{"c":3,"x":4}],"c":"b"}' as JSONB) @> '{"a":[{"x":4},3]}';

select cast('{"a":[1,2,{"c":3,"x":4}],"c":"b"}' as JSONB) @> '{"a":[{"x":4},1]}';

create temporary table nestjsonb (j JSONB);

insert into nestjsonb (j) values ('{"a":[["b",{"x":1}],["b",{"x":2}]],"c":3}');

insert into nestjsonb (j) values ('[[14,2,3]]');

insert into nestjsonb (j) values ('[1,[14,2,3]]');

create index on nestjsonb using gin (j jsonb_path_ops);

set enable_seqscan = 'on';

set enable_bitmapscan = off;

select * from nestjsonb where j @> cast('{"a":[[{"x":2}]]}' as JSONB);

select * from nestjsonb where j @> '{"c":3}';

select * from nestjsonb where j @> '[[14]]';

set enable_seqscan = off;

set enable_bitmapscan = 'on';

select * from nestjsonb where j @> cast('{"a":[[{"x":2}]]}' as JSONB);

select * from nestjsonb where j @> '{"c":3}';

select * from nestjsonb where j @> '[[14]]';

reset enable_seqscan;

reset enable_bitmapscan;

select cast('{"n":null,"a":1,"b":[1,2],"c":{"1":2},"d":{"1":[2,3]}}' as JSONB) -> 'n';

select cast('{"n":null,"a":1,"b":[1,2],"c":{"1":2},"d":{"1":[2,3]}}' as JSONB) -> 'a';

select cast('{"n":null,"a":1,"b":[1,2],"c":{"1":2},"d":{"1":[2,3]}}' as JSONB) -> 'b';

select cast('{"n":null,"a":1,"b":[1,2],"c":{"1":2},"d":{"1":[2,3]}}' as JSONB) -> 'c';

select cast('{"n":null,"a":1,"b":[1,2],"c":{"1":2},"d":{"1":[2,3]}}' as JSONB) -> 'd';

select cast('{"n":null,"a":1,"b":[1,2],"c":{"1":2},"d":{"1":[2,3]}}' as JSONB) -> 'd' -> '1';

select cast('{"n":null,"a":1,"b":[1,2],"c":{"1":2},"d":{"1":[2,3]}}' as JSONB) -> 'e';

select cast('{"n":null,"a":1,"b":[1,2],"c":{"1":2},"d":{"1":[2,3]}}' as JSONB) -> 0;

select cast('["a","b","c",[1,2],null]' as JSONB) -> 0;

select cast('["a","b","c",[1,2],null]' as JSONB) -> 1;

select cast('["a","b","c",[1,2],null]' as JSONB) -> 2;

select cast('["a","b","c",[1,2],null]' as JSONB) -> 3;

select cast('["a","b","c",[1,2],null]' as JSONB) -> 3 -> 1;

select cast('["a","b","c",[1,2],null]' as JSONB) -> 4;

select cast('["a","b","c",[1,2],null]' as JSONB) -> 5;

select cast('["a","b","c",[1,2],null]' as JSONB) -> -1;

select cast('["a","b","c",[1,2],null]' as JSONB) -> -5;

select cast('["a","b","c",[1,2],null]' as JSONB) -> -6;

select cast('{"a":"b","c":[1,2,3]}' as JSONB) #> '{0}';

select cast('{"a":"b","c":[1,2,3]}' as JSONB) #> '{a}';

select cast('{"a":"b","c":[1,2,3]}' as JSONB) #> '{c}';

select cast('{"a":"b","c":[1,2,3]}' as JSONB) #> '{c,0}';

select cast('{"a":"b","c":[1,2,3]}' as JSONB) #> '{c,1}';

select cast('{"a":"b","c":[1,2,3]}' as JSONB) #> '{c,2}';

select cast('{"a":"b","c":[1,2,3]}' as JSONB) #> '{c,3}';

select cast('{"a":"b","c":[1,2,3]}' as JSONB) #> '{c,-1}';

select cast('{"a":"b","c":[1,2,3]}' as JSONB) #> '{c,-3}';

select cast('{"a":"b","c":[1,2,3]}' as JSONB) #> '{c,-4}';

select cast('[0,1,2,[3,4],{"5":"five"}]' as JSONB) #> '{0}';

select cast('[0,1,2,[3,4],{"5":"five"}]' as JSONB) #> '{3}';

select cast('[0,1,2,[3,4],{"5":"five"}]' as JSONB) #> '{4}';

select cast('[0,1,2,[3,4],{"5":"five"}]' as JSONB) #> '{4,5}';

select cast('{"n":null,"a":1,"b":[1,2],"c":{"1":2},"d":{"1":[2,3]}}' as JSONB) ? 'n';

select cast('{"n":null,"a":1,"b":[1,2],"c":{"1":2},"d":{"1":[2,3]}}' as JSONB) ? 'a';

select cast('{"n":null,"a":1,"b":[1,2],"c":{"1":2},"d":{"1":[2,3]}}' as JSONB) ? 'b';

select cast('{"n":null,"a":1,"b":[1,2],"c":{"1":2},"d":{"1":[2,3]}}' as JSONB) ? 'c';

select cast('{"n":null,"a":1,"b":[1,2],"c":{"1":2},"d":{"1":[2,3]}}' as JSONB) ? 'd';

select cast('{"n":null,"a":1,"b":[1,2],"c":{"1":2},"d":{"1":[2,3]}}' as JSONB) ? 'e';

select jsonb_strip_nulls(null);

select jsonb_strip_nulls('1');

select jsonb_strip_nulls('"a string"');

select jsonb_strip_nulls('null');

select jsonb_strip_nulls('[1,2,null,3,4]');

select jsonb_strip_nulls('{"a":1,"b":null,"c":[2,null,3],"d":{"e":4,"f":null}}');

select jsonb_strip_nulls('[1,{"a":1,"b":null,"c":2},3]');

select jsonb_strip_nulls('{"a": {"b": null, "c": null}, "d": {} }');

select jsonb_strip_nulls(null, true);

select jsonb_strip_nulls('1', true);

select jsonb_strip_nulls('"a string"', true);

select jsonb_strip_nulls('null', true);

select jsonb_strip_nulls('[1,2,null,3,4]', true);

select jsonb_strip_nulls('{"a":1,"b":null,"c":[2,null,3],"d":{"e":4,"f":null}}', true);

select jsonb_strip_nulls('[1,{"a":1,"b":null,"c":2},3]', true);

select jsonb_strip_nulls('{"a": {"b": null, "c": null}, "d": {} }', true);

select
  jsonb_pretty(
    '{"a": "test", "b": [1, 2, 3], "c": "test3", "d":{"dd": "test4", "dd2":{"ddd": "test5"}}}'
  );

select jsonb_pretty('[{"f1":1,"f2":null},2,null,[[{"x":true},6,7],8],3]');

select jsonb_pretty('{"a":["b", "c"], "d": {"e":"f"}}');

select jsonb_concat('{"d": "test", "a": [1, 2]}', '{"g": "test2", "c": {"c1":1, "c2":2}}');

select cast('{"aa":1 , "b":2, "cq":3}' as JSONB) || '{"cq":"l", "b":"g", "fg":false}';

select cast('{"aa":1 , "b":2, "cq":3}' as JSONB) || '{"aq":"l"}';

select cast('{"aa":1 , "b":2, "cq":3}' as JSONB) || '{"aa":"l"}';

select cast('{"aa":1 , "b":2, "cq":3}' as JSONB) || '{}';

select cast('["a", "b"]' as JSONB) || '["c"]';

select cast('["a", "b"]' as JSONB) || '["c", "d"]';

select '["c"]' || cast('["a", "b"]' as JSONB);

select cast('["a", "b"]' as JSONB) || '"c"';

select '"c"' || cast('["a", "b"]' as JSONB);

select cast('[]' as JSONB) || cast('["a"]' as JSONB);

select cast('[]' as JSONB) || cast('"a"' as JSONB);

select cast('"b"' as JSONB) || cast('"a"' as JSONB);

select cast('{}' as JSONB) || cast('{"a":"b"}' as JSONB);

select cast('[]' as JSONB) || cast('{"a":"b"}' as JSONB);

select cast('{"a":"b"}' as JSONB) || cast('[]' as JSONB);

select cast('"a"' as JSONB) || '{"a":1}';

select '{"a":1}' || cast('"a"' as JSONB);

select cast('[3]' as JSONB) || cast('{}' as JSONB);

select cast('3' as JSONB) || cast('[]' as JSONB);

select cast('3' as JSONB) || cast('4' as JSONB);

select cast('3' as JSONB) || cast('{}' as JSONB);

select cast('["a", "b"]' as JSONB) || '{"c":1}';

select cast('{"c": 1}' as JSONB) || '["a", "b"]';

select cast('{}' as JSONB) || '{"cq":"l", "b":"g", "fg":false}';

select
  pg_column_size(
    cast('{}' as JSONB) || cast('{}' as JSONB)
  ) =
  pg_column_size(cast('{}' as JSONB));

select
  pg_column_size(
    cast('{"aa":1}' as JSONB) ||
    cast('{"b":2}' as JSONB)
  ) =
  pg_column_size(cast('{"aa":1, "b":2}' as JSONB));

select
  pg_column_size(
    cast('{"aa":1, "b":2}' as JSONB) ||
    cast('{}' as JSONB)
  ) =
  pg_column_size(cast('{"aa":1, "b":2}' as JSONB));

select
  pg_column_size(
    cast('{}' as JSONB) ||
    cast('{"aa":1, "b":2}' as JSONB)
  ) =
  pg_column_size(cast('{"aa":1, "b":2}' as JSONB));

select jsonb_delete(cast('{"a":1 , "b":2, "c":3}' as JSONB), 'a');

select jsonb_delete(cast('{"a":null , "b":2, "c":3}' as JSONB), 'a');

select jsonb_delete(cast('{"a":1 , "b":2, "c":3}' as JSONB), 'b');

select jsonb_delete(cast('{"a":1 , "b":2, "c":3}' as JSONB), 'c');

select jsonb_delete(cast('{"a":1 , "b":2, "c":3}' as JSONB), 'd');

select cast('{"a":1 , "b":2, "c":3}' as JSONB) - 'a';

select cast('{"a":null , "b":2, "c":3}' as JSONB) - 'a';

select cast('{"a":1 , "b":2, "c":3}' as JSONB) - 'b';

select cast('{"a":1 , "b":2, "c":3}' as JSONB) - 'c';

select cast('{"a":1 , "b":2, "c":3}' as JSONB) - 'd';

select
  pg_column_size(
    cast('{"a":1 , "b":2, "c":3}' as JSONB) - 'b'
  ) =
  pg_column_size(cast('{"a":1, "b":2}' as JSONB));

select cast('["a","b","c"]' as JSONB) - 3;

select cast('["a","b","c"]' as JSONB) - 2;

select cast('["a","b","c"]' as JSONB) - 1;

select cast('["a","b","c"]' as JSONB) - 0;

select cast('["a","b","c"]' as JSONB) - -1;

select cast('["a","b","c"]' as JSONB) - -2;

select cast('["a","b","c"]' as JSONB) - -3;

select cast('["a","b","c"]' as JSONB) - -4;

select cast('{"a":1 , "b":2, "c":3}' as JSONB) - cast('{b}' as TEXT[]);

select cast('{"a":1 , "b":2, "c":3}' as JSONB) - cast('{c,b}' as TEXT[]);

select cast('{"a":1 , "b":2, "c":3}' as JSONB) - cast('{}' as TEXT[]);

select
  jsonb_set(
    cast('{"n":null, "a":1, "b":[1,2], "c":{"1":2}, "d":{"1":[2,3]}}'
    as JSONB),
    '{n}',
    '[1,2,3]'
  );

select
  jsonb_set(
    cast('{"n":null, "a":1, "b":[1,2], "c":{"1":2}, "d":{"1":[2,3]}}'
    as JSONB),
    '{b,-1}',
    '[1,2,3]'
  );

select
  jsonb_set(
    cast('{"n":null, "a":1, "b":[1,2], "c":{"1":2}, "d":{"1":[2,3]}}'
    as JSONB),
    '{d,1,0}',
    '[1,2,3]'
  );

select
  jsonb_set(
    cast('{"n":null, "a":1, "b":[1,2], "c":{"1":2}, "d":{"1":[2,3]}}'
    as JSONB),
    '{d,NULL,0}',
    '[1,2,3]'
  );

select
  jsonb_set(
    cast('{"n":null, "a":1, "b":[1,2], "c":{"1":2}, "d":{"1":[2,3]}}'
    as JSONB),
    '{n}',
    '{"1": 2}'
  );

select
  jsonb_set(
    cast('{"n":null, "a":1, "b":[1,2], "c":{"1":2}, "d":{"1":[2,3]}}'
    as JSONB),
    '{b,-1}',
    '{"1": 2}'
  );

select
  jsonb_set(
    cast('{"n":null, "a":1, "b":[1,2], "c":{"1":2}, "d":{"1":[2,3]}}'
    as JSONB),
    '{d,1,0}',
    '{"1": 2}'
  );

select
  jsonb_set(
    cast('{"n":null, "a":1, "b":[1,2], "c":{"1":2}, "d":{"1":[2,3]}}'
    as JSONB),
    '{d,NULL,0}',
    '{"1": 2}'
  );

select
  jsonb_set(
    cast('{"n":null, "a":1, "b":[1,2], "c":{"1":2}, "d":{"1":[2,3]}}'
    as JSONB),
    '{b,-1}',
    '"test"'
  );

select
  jsonb_set(
    cast('{"n":null, "a":1, "b":[1,2], "c":{"1":2}, "d":{"1":[2,3]}}'
    as JSONB),
    '{b,-1}',
    '{"f": "test"}'
  );

select jsonb_delete_path('{"n":null, "a":1, "b":[1,2], "c":{"1":2}, "d":{"1":[2,3]}}', '{n}');

select jsonb_delete_path('{"n":null, "a":1, "b":[1,2], "c":{"1":2}, "d":{"1":[2,3]}}', '{b,-1}');

select jsonb_delete_path('{"n":null, "a":1, "b":[1,2], "c":{"1":2}, "d":{"1":[2,3]}}', '{d,1,0}');

select jsonb_delete_path('{"a":[]}', '{"a",-2147483648}');

select cast('{"n":null, "a":1, "b":[1,2], "c":{"1":2}, "d":{"1":[2,3]}}' as JSONB) #- '{n}';

select cast('{"n":null, "a":1, "b":[1,2], "c":{"1":2}, "d":{"1":[2,3]}}' as JSONB) #- '{b,-1}';

select cast('{"n":null, "a":1, "b":[1,2], "c":{"1":2}, "d":{"1":[2,3]}}' as JSONB) #- '{b,-1e}';

select cast('{"n":null, "a":1, "b":[1,2], "c":{"1":2}, "d":{"1":[2,3]}}' as JSONB) #- '{d,1,0}';

select cast('"a"' as JSONB) - 'a';

select cast('{}' as JSONB) - 'a';

select cast('[]' as JSONB) - 'a';

select cast('"a"' as JSONB) - 1;

select cast('{}' as JSONB) - 1;

select cast('[]' as JSONB) - 1;

select cast('"a"' as JSONB) #- '{a}';

select cast('{}' as JSONB) #- '{a}';

select cast('[]' as JSONB) #- '{a}';

select jsonb_set('"a"', '{a}', '"b"');

select jsonb_set('{}', '{a}', '"b"', false);

select jsonb_set('[]', '{1}', '"b"', false);

select jsonb_set('[{"f1":1,"f2":null},2,null,3]', '{0}', '[2,3,4]', false);

select jsonb_set('{"a":1,"b":[0,1,2],"c":{"d":4}}', '{b,-33}', '{"foo":123}');

select jsonb_set('{"a":1,"b":[0,1,2],"c":{"d":4}}', '{b,33}', '{"foo":123}');

select jsonb_set('{"a":1,"b":[4,5,[0,1,2],6,7],"c":{"d":4}}', '{b,2,33}', '{"foo":123}');

select jsonb_set('{"a":1,"b":[0,1,2],"c":{"d":4}}', '{c,e}', '{"foo":123}');

select jsonb_set('{"a":1,"b":[0,1,2],"c":{"d":4}}', '{x,-33}', '{"foo":123}');

select jsonb_set('{"a":1,"b":[0,1,2],"c":{"d":4}}', '{x,y}', '{"foo":123}');

select jsonb_set('{}', '{x}', '{"foo":123}');

select jsonb_set('[]', '{0}', '{"foo":123}');

select jsonb_set('[]', '{99}', '{"foo":123}');

select jsonb_set('[]', '{-99}', '{"foo":123}');

select jsonb_set('{"a": [1, 2, 3]}', '{a, non_integer}', '"new_value"');

select jsonb_set('{"a": {"b": [1, 2, 3]}}', '{a, b, non_integer}', '"new_value"');

select jsonb_set('{"a": {"b": [1, 2, 3]}}', '{a, b, NULL}', '"new_value"');

select jsonb_set_lax('{"a":1,"b":2}', '{b}', '5');

select jsonb_set_lax('{"a":1,"b":2}', '{d}', '6', true);

select jsonb_set_lax('{"a":1,"b":2}', '{b}', null);

select jsonb_set_lax('{"a":1,"b":2}', '{d}', null, true);

select jsonb_set_lax('{"a":1,"b":2}', '{b}', null, true, null);

select jsonb_set_lax('{"a":1,"b":2}', '{b}', null, true, 'no_such_treatment');

select
  jsonb_set_lax(
    '{"a":1,"b":2}',
    '{b}',
    null,
    "null_value_treatment" := 'raise_exception'
  )
  as raise_exception;

select
  jsonb_set_lax(
    '{"a":1,"b":2}',
    '{b}',
    null,
    "null_value_treatment" := 'return_target'
  )
  as return_target;

select
  jsonb_set_lax(
    '{"a":1,"b":2}',
    '{b}',
    null,
    "null_value_treatment" := 'delete_key'
  )
  as delete_key;

select
  jsonb_set_lax(
    '{"a":1,"b":2}',
    '{b}',
    null,
    "null_value_treatment" := 'use_json_null'
  )
  as use_json_null;

select jsonb_insert('{"a": [0,1,2]}', '{a, 1}', '"new_value"');

select jsonb_insert('{"a": [0,1,2]}', '{a, 1}', '"new_value"', true);

select jsonb_insert('{"a": {"b": {"c": [0, 1, "test1", "test2"]}}}', '{a, b, c, 2}', '"new_value"');

select
  jsonb_insert(
    '{"a": {"b": {"c": [0, 1, "test1", "test2"]}}}',
    '{a, b, c, 2}',
    '"new_value"',
    true
  );

select jsonb_insert('{"a": [0,1,2]}', '{a, 1}', '{"b": "value"}');

select jsonb_insert('{"a": [0,1,2]}', '{a, 1}', '["value1", "value2"]');

select jsonb_insert('{"a": [0,1,2]}', '{a, 0}', '"new_value"');

select jsonb_insert('{"a": [0,1,2]}', '{a, 0}', '"new_value"', true);

select jsonb_insert('{"a": [0,1,2]}', '{a, 2}', '"new_value"');

select jsonb_insert('{"a": [0,1,2]}', '{a, 2}', '"new_value"', true);

select jsonb_insert('{"a": [0,1,2]}', '{a, -1}', '"new_value"');

select jsonb_insert('{"a": [0,1,2]}', '{a, -1}', '"new_value"', true);

select jsonb_insert('[]', '{1}', '"new_value"');

select jsonb_insert('[]', '{1}', '"new_value"', true);

select jsonb_insert('{"a": []}', '{a, 1}', '"new_value"');

select jsonb_insert('{"a": []}', '{a, 1}', '"new_value"', true);

select jsonb_insert('{"a": [0,1,2]}', '{a, 10}', '"new_value"');

select jsonb_insert('{"a": [0,1,2]}', '{a, -10}', '"new_value"');

select jsonb_insert('{"a": {"b": "value"}}', '{a, c}', '"new_value"');

select jsonb_insert('{"a": {"b": "value"}}', '{a, c}', '"new_value"', true);

select jsonb_insert('{"a": {"b": "value"}}', '{a, b}', '"new_value"');

select jsonb_insert('{"a": {"b": "value"}}', '{a, b}', '"new_value"', true);

select (cast('123' as JSONB))['a'];

select (cast('123' as JSONB))[0];

select (cast('123' as JSONB))[null];

select (cast('{"a": 1}' as JSONB))['a'];

select (cast('{"a": 1}' as JSONB))[0];

select (cast('{"a": 1}' as JSONB))['not_exist'];

select (cast('{"a": 1}' as JSONB))[null];

select (cast('[1, "2", null]' as JSONB))['a'];

select (cast('[1, "2", null]' as JSONB))[0];

select (cast('[1, "2", null]' as JSONB))['1'];

select (cast('[1, "2", null]' as JSONB))[1.0];

select (cast('[1, "2", null]' as JSONB))[2];

select (cast('[1, "2", null]' as JSONB))[3];

select (cast('[1, "2", null]' as JSONB))[-2];

select (cast('[1, "2", null]' as JSONB))[1]['a'];

select (cast('[1, "2", null]' as JSONB))[1][0];

select (cast('{"a": 1, "b": "c", "d": [1, 2, 3]}' as JSONB))['b'];

select (cast('{"a": 1, "b": "c", "d": [1, 2, 3]}' as JSONB))['d'];

select (cast('{"a": 1, "b": "c", "d": [1, 2, 3]}' as JSONB))['d'][1];

select (cast('{"a": 1, "b": "c", "d": [1, 2, 3]}' as JSONB))['d']['a'];

select (cast('{"a": {"a1": {"a2": "aaa"}}, "b": "bbb", "c": "ccc"}' as JSONB))['a']['a1'];

select (cast('{"a": {"a1": {"a2": "aaa"}}, "b": "bbb", "c": "ccc"}' as JSONB))['a']['a1']['a2'];

select
  (cast('{"a": {"a1": {"a2": "aaa"}}, "b": "bbb", "c": "ccc"}'
  as JSONB))['a']['a1']['a2']['a3'];

select (cast('{"a": ["a1", {"b1": ["aaa", "bbb", "ccc"]}], "b": "bb"}' as JSONB))['a'][1]['b1'];

select (cast('{"a": ["a1", {"b1": ["aaa", "bbb", "ccc"]}], "b": "bb"}' as JSONB))['a'][1]['b1'][2];

select (cast('{"a": 1}' as JSONB))['a':'b'];

select (cast('[1, "2", null]' as JSONB))[1:2];

select (cast('[1, "2", null]' as JSONB))[:2];

select (cast('[1, "2", null]' as JSONB))[1:];

select (cast('[1, "2", null]' as JSONB))[:];

create temporary table test_jsonb_subscript (
  id INT,
  test_json JSONB
);

insert into test_jsonb_subscript values (1, '{}'), (2, '{"key": "value"}');

update test_jsonb_subscript set test_json['a'] = '1' where id = 1;

select * from test_jsonb_subscript;

update test_jsonb_subscript set test_json['a'] = '1' where id = 2;

select * from test_jsonb_subscript;

update test_jsonb_subscript set test_json['a'] = '"test"';

select * from test_jsonb_subscript;

update test_jsonb_subscript set test_json['a'] = cast('{"b": 1}' as JSONB);

select * from test_jsonb_subscript;

update test_jsonb_subscript set test_json['a'] = cast('[1, 2, 3]' as JSONB);

select * from test_jsonb_subscript;

select * from test_jsonb_subscript where test_json['key'] = '"value"';

select * from test_jsonb_subscript where test_json['key_doesnt_exists'] = '"value"';

select * from test_jsonb_subscript where test_json['key'] = '"wrong_value"';

update test_jsonb_subscript set test_json[null] = '1';

update test_jsonb_subscript set test_json['another_key'] = null;

select * from test_jsonb_subscript;

insert into test_jsonb_subscript values (3, null);

update test_jsonb_subscript set test_json['a'] = '1' where id = 3;

select * from test_jsonb_subscript;

update test_jsonb_subscript set test_json = null where id = 3;

update test_jsonb_subscript set test_json[0] = '1';

select * from test_jsonb_subscript;

delete from test_jsonb_subscript;

insert into test_jsonb_subscript values (1, '[0]');

update test_jsonb_subscript set test_json[5] = '1';

select * from test_jsonb_subscript;

update test_jsonb_subscript set test_json[-4] = '1';

select * from test_jsonb_subscript;

update test_jsonb_subscript set test_json[-8] = '1';

select * from test_jsonb_subscript;

delete from test_jsonb_subscript;

insert into test_jsonb_subscript values (1, '[]');

update test_jsonb_subscript set test_json[5] = '1';

select * from test_jsonb_subscript;

delete from test_jsonb_subscript;

insert into test_jsonb_subscript values (1, '{}');

update test_jsonb_subscript set test_json['a'][0]['b'][0]['c'] = '1';

select * from test_jsonb_subscript;

delete from test_jsonb_subscript;

insert into test_jsonb_subscript values (1, '{}');

update test_jsonb_subscript set test_json['a'][2]['b'][2]['c'][2] = '1';

select * from test_jsonb_subscript;

delete from test_jsonb_subscript;

insert into test_jsonb_subscript values (1, '{"b": 1}');

update test_jsonb_subscript set test_json['a'][0] = '2';

select * from test_jsonb_subscript;

delete from test_jsonb_subscript;

insert into test_jsonb_subscript values (1, '{}');

update test_jsonb_subscript set test_json[0]['a'] = '1';

select * from test_jsonb_subscript;

delete from test_jsonb_subscript;

insert into test_jsonb_subscript values (1, '[]');

update test_jsonb_subscript set test_json[0]['a'] = '1';

update test_jsonb_subscript set test_json[2]['b'] = '2';

select * from test_jsonb_subscript;

delete from test_jsonb_subscript;

insert into test_jsonb_subscript values (1, '{}');

update test_jsonb_subscript set test_json['a']['b'][1] = '1';

update test_jsonb_subscript set test_json['a']['b'][10] = '1';

select * from test_jsonb_subscript;

delete from test_jsonb_subscript;

insert into test_jsonb_subscript values (1, '[]');

update test_jsonb_subscript set test_json[0][0][0] = '1';

update test_jsonb_subscript set test_json[0][0][1] = '1';

select * from test_jsonb_subscript;

delete from test_jsonb_subscript;

insert into test_jsonb_subscript values (1, '{}');

update test_jsonb_subscript set test_json['a']['b'][10] = '1';

update test_jsonb_subscript set test_json['a'][10][10] = '1';

select * from test_jsonb_subscript;

delete from test_jsonb_subscript;

insert into test_jsonb_subscript values (1, '{"a": {}}');

update test_jsonb_subscript set test_json['a']['b']['c'][2] = '1';

select * from test_jsonb_subscript;

delete from test_jsonb_subscript;

insert into test_jsonb_subscript values (1, '{"a": []}');

update test_jsonb_subscript set test_json['a'][1]['c'][2] = '1';

select * from test_jsonb_subscript;

delete from test_jsonb_subscript;

insert into test_jsonb_subscript values (1, '{"a": 1}');

update test_jsonb_subscript set test_json['a']['b'] = '1';

update test_jsonb_subscript set test_json['a']['b']['c'] = '1';

update test_jsonb_subscript set test_json['a'][0] = '1';

update test_jsonb_subscript set test_json['a'][0]['c'] = '1';

update test_jsonb_subscript set test_json['a'][0][0] = '1';

delete from test_jsonb_subscript;

insert into test_jsonb_subscript values (1, 'null');

update test_jsonb_subscript set test_json[0] = '1';

update test_jsonb_subscript set test_json[0][0] = '1';

drop TABLE test_jsonb_subscript;

create temporary table test_jsonb_subscript (
  id TEXT,
  test_json JSONB
);

insert into test_jsonb_subscript values ('foo', '{"foo": "bar"}');

insert into test_jsonb_subscript
select
  s,
  cast('{"' || s || '": "bar"}' as JSONB)
from
  repeat('xyzzy', 500) as s;

select length(id), test_json[id] from test_jsonb_subscript;

update test_jsonb_subscript set test_json[id] = '"baz"';

select length(id), test_json[id] from test_jsonb_subscript;

select * from test_jsonb_subscript;

select
  to_tsvector(
    cast('{"a": "aaa bbb ddd ccc", "b": ["eee fff ggg"], "c": {"d": "hhh iii"}}'
    as JSONB)
  );

select
  to_tsvector(
    'simple',
    cast('{"a": "aaa bbb ddd ccc", "b": ["eee fff ggg"], "c": {"d": "hhh iii"}}'
    as JSONB)
  );

select
  to_tsvector(
    'english',
    cast('{"a": "aaa in bbb ddd ccc", "b": ["the eee fff ggg"], "c": {"d": "hhh. iii"}}'
    as JSONB)
  );

select to_tsvector('english', cast('{"a": "aaa in bbb ddd ccc", "b": 123, "c": 456}' as JSONB));

select
  jsonb_to_tsvector(
    'english',
    cast('{"a": "aaa in bbb", "b": 123, "c": 456, "d": true, "f": false, "g": null}'
    as JSONB),
    '"all"'
  );

select
  jsonb_to_tsvector(
    'english',
    cast('{"a": "aaa in bbb", "b": 123, "c": 456, "d": true, "f": false, "g": null}'
    as JSONB),
    '"key"'
  );

select
  jsonb_to_tsvector(
    'english',
    cast('{"a": "aaa in bbb", "b": 123, "c": 456, "d": true, "f": false, "g": null}'
    as JSONB),
    '"string"'
  );

select
  jsonb_to_tsvector(
    'english',
    cast('{"a": "aaa in bbb", "b": 123, "c": 456, "d": true, "f": false, "g": null}'
    as JSONB),
    '"numeric"'
  );

select
  jsonb_to_tsvector(
    'english',
    cast('{"a": "aaa in bbb", "b": 123, "c": 456, "d": true, "f": false, "g": null}'
    as JSONB),
    '"boolean"'
  );

select
  jsonb_to_tsvector(
    'english',
    cast('{"a": "aaa in bbb", "b": 123, "c": 456, "d": true, "f": false, "g": null}'
    as JSONB),
    '["string", "numeric"]'
  );

select
  jsonb_to_tsvector(
    'english',
    cast('{"a": "aaa in bbb", "b": 123, "c": 456, "d": true, "f": false, "g": null}'
    as JSONB),
    '"all"'
  );

select
  jsonb_to_tsvector(
    'english',
    cast('{"a": "aaa in bbb", "b": 123, "c": 456, "d": true, "f": false, "g": null}'
    as JSONB),
    '"key"'
  );

select
  jsonb_to_tsvector(
    'english',
    cast('{"a": "aaa in bbb", "b": 123, "c": 456, "d": true, "f": false, "g": null}'
    as JSONB),
    '"string"'
  );

select
  jsonb_to_tsvector(
    'english',
    cast('{"a": "aaa in bbb", "b": 123, "c": 456, "d": true, "f": false, "g": null}'
    as JSONB),
    '"numeric"'
  );

select
  jsonb_to_tsvector(
    'english',
    cast('{"a": "aaa in bbb", "b": 123, "c": 456, "d": true, "f": false, "g": null}'
    as JSONB),
    '"boolean"'
  );

select
  jsonb_to_tsvector(
    'english',
    cast('{"a": "aaa in bbb", "b": 123, "c": 456, "d": true, "f": false, "g": null}'
    as JSONB),
    '["string", "numeric"]'
  );

select to_tsvector(cast('""' as JSONB));

select to_tsvector(cast('{}' as JSONB));

select to_tsvector(cast('[]' as JSONB));

select to_tsvector(cast('null' as JSONB));

select jsonb_to_tsvector(cast('""' as JSONB), '"all"');

select jsonb_to_tsvector(cast('{}' as JSONB), '"all"');

select jsonb_to_tsvector(cast('[]' as JSONB), '"all"');

select jsonb_to_tsvector(cast('null' as JSONB), '"all"');

select
  jsonb_to_tsvector(
    'english',
    cast('{"a": "aaa in bbb", "b": 123, "c": 456, "d": true, "f": false, "g": null}'
    as JSONB),
    '""'
  );

select
  jsonb_to_tsvector(
    'english',
    cast('{"a": "aaa in bbb", "b": 123, "c": 456, "d": true, "f": false, "g": null}'
    as JSONB),
    '{}'
  );

select
  jsonb_to_tsvector(
    'english',
    cast('{"a": "aaa in bbb", "b": 123, "c": 456, "d": true, "f": false, "g": null}'
    as JSONB),
    '[]'
  );

select
  jsonb_to_tsvector(
    'english',
    cast('{"a": "aaa in bbb", "b": 123, "c": 456, "d": true, "f": false, "g": null}'
    as JSONB),
    'null'
  );

select
  jsonb_to_tsvector(
    'english',
    cast('{"a": "aaa in bbb", "b": 123, "c": 456, "d": true, "f": false, "g": null}'
    as JSONB),
    '["all", null]'
  );

select
  ts_headline(
    cast('{"a": "aaa bbb", "b": {"c": "ccc ddd fff", "c1": "ccc1 ddd1"}, "d": ["ggg hhh", "iii jjj"]}'
    as JSONB),
    tsquery('bbb & ddd & hhh')
  );

select
  ts_headline(
    'english',
    cast('{"a": "aaa bbb", "b": {"c": "ccc ddd fff"}, "d": ["ggg hhh", "iii jjj"]}'
    as JSONB),
    tsquery('bbb & ddd & hhh')
  );

select
  ts_headline(
    cast('{"a": "aaa bbb", "b": {"c": "ccc ddd fff", "c1": "ccc1 ddd1"}, "d": ["ggg hhh", "iii jjj"]}'
    as JSONB),
    tsquery('bbb & ddd & hhh'),
    'StartSel = <, StopSel = >'
  );

select
  ts_headline(
    'english',
    cast('{"a": "aaa bbb", "b": {"c": "ccc ddd fff", "c1": "ccc1 ddd1"}, "d": ["ggg hhh", "iii jjj"]}'
    as JSONB),
    tsquery('bbb & ddd & hhh'),
    'StartSel = <, StopSel = >'
  );

select ts_headline(cast('null' as JSONB), tsquery('aaa & bbb'));

select ts_headline(cast('{}' as JSONB), tsquery('aaa & bbb'));

select ts_headline(cast('[]' as JSONB), tsquery('aaa & bbb'));

select cast(cast('true' as JSONB) as BOOLEAN);

select cast(cast('null' as JSONB) as BOOLEAN);

select cast(cast('[]' as JSONB) as BOOLEAN);

select cast(cast('1.0' as JSONB) as DOUBLE PRECISION);

select cast(cast('null' as JSONB) as DOUBLE PRECISION);

select cast(cast('[1.0]' as JSONB) as DOUBLE PRECISION);

select cast(cast('1.0' as JSONB) as REAL);

select cast(cast('null' as JSONB) as REAL);

select cast(cast('[1.0]' as JSONB) as REAL);

select cast(cast('12345' as JSONB) as SMALLINT);

select cast(cast('null' as JSONB) as SMALLINT);

select cast(cast('"hello"' as JSONB) as SMALLINT);

select cast(cast('12345' as JSONB) as INT);

select cast(cast('null' as JSONB) as INT);

select cast(cast('"hello"' as JSONB) as INT);

select cast(cast('12345' as JSONB) as BIGINT);

select cast(cast('null' as JSONB) as BIGINT);

select cast(cast('"hello"' as JSONB) as BIGINT);

select cast(cast('12345' as JSONB) as NUMERIC);

select cast(cast('null' as JSONB) as NUMERIC);

select cast(cast('{}' as JSONB) as NUMERIC);

select cast(cast('12345.05' as JSONB) as NUMERIC);

select cast(cast('12345.05' as JSONB) as REAL);

select cast(cast('12345.05' as JSONB) as DOUBLE PRECISION);

select cast(cast('12345.05' as JSONB) as SMALLINT);

select cast(cast('12345.05' as JSONB) as INT);

select cast(cast('12345.05' as JSONB) as BIGINT);

select cast(cast('12345.0000000000000000000000000000000000000000000005' as JSONB) as NUMERIC);

select cast(cast('12345.0000000000000000000000000000000000000000000005' as JSONB) as REAL);

select
  cast(cast('12345.0000000000000000000000000000000000000000000005'
  as JSONB)
  as DOUBLE PRECISION);

select cast(cast('12345.0000000000000000000000000000000000000000000005' as JSONB) as SMALLINT);

select cast(cast('12345.0000000000000000000000000000000000000000000005' as JSONB) as INT);

select cast(cast('12345.0000000000000000000000000000000000000000000005' as JSONB) as BIGINT);
