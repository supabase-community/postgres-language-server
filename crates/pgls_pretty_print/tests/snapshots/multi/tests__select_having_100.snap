---
source: crates/pgls_pretty_print/tests/tests.rs
input_file: crates/pgls_pretty_print/tests/data/multi/select_having.sql
snapshot_kind: text
---
create table test_having (
  a INT,
  b INT,
  c CHAR(8),
  d CHAR(1)
);

insert into test_having values (0, 1, 'XXXX', 'A');

insert into test_having values (1, 2, 'AAAA', 'b');

insert into test_having values (2, 2, 'AAAA', 'c');

insert into test_having values (3, 3, 'BBBB', 'D');

insert into test_having values (4, 3, 'BBBB', 'e');

insert into test_having values (5, 3, 'bbbb', 'F');

insert into test_having values (6, 4, 'cccc', 'g');

insert into test_having values (7, 4, 'cccc', 'h');

insert into test_having values (8, 4, 'CCCC', 'I');

insert into test_having values (9, 4, 'CCCC', 'j');

select b, c from test_having group by b, c having COUNT(*) = 1 order by b, c;

select b, c from test_having group by b, c having b = 3 order by b, c;

select
  lower(c),
  COUNT(c)
from
  test_having
group by lower(c)
having
  COUNT(*) > 2 or MIN(a) = MAX(a)
order by lower(c);

select c, MAX(a) from test_having group by c having COUNT(*) > 2 or MIN(a) = MAX(a) order by c;

select MIN(a), MAX(a) from test_having having MIN(a) = MAX(a);

select MIN(a), MAX(a) from test_having having MIN(a) < MAX(a);

select a from test_having having MIN(a) < MAX(a);

select 1 as one from test_having having a > 1;

select 1 as one from test_having having 1 > 2;

select 1 as one from test_having having 1 < 2;

select 1 as one from test_having where 1 / a = 1 having 1 < 2;

drop TABLE "test_having";
