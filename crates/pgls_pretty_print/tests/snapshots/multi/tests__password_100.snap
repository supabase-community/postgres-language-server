---
source: crates/pgls_pretty_print/tests/tests.rs
input_file: crates/pgls_pretty_print/tests/data/multi/password.sql
snapshot_kind: text
---
set password_encryption = novalue;

set password_encryption = 'true';

set password_encryption = md5;

set password_encryption = 'scram-sha-256';

set password_encryption = md5;

create role regress_passwd1;

alter role regress_passwd1 password 'role_pwd1';

create role regress_passwd2;

alter role regress_passwd2 password 'role_pwd2';

set password_encryption = 'scram-sha-256';

create role regress_passwd3 password 'role_pwd3';

create role regress_passwd4 password null;

select
  rolname,
  regexp_replace(
    rolpassword,
    '(SCRAM-SHA-256)\$(\d+):([a-zA-Z0-9+/=]+)\$([a-zA-Z0-9+=/]+):([a-zA-Z0-9+/=]+)',
    '\1$\2:<salt>$<storedkey>:<serverkey>'
  )
  as rolpassword_masked
from
  pg_authid
where
  rolname like 'regress_passwd%'
order by rolname,
  rolpassword;

alter role regress_passwd2 rename to regress_passwd2_new;

select
  rolname,
  rolpassword
from
  pg_authid
where
  rolname like 'regress_passwd2_new'
order by rolname,
  rolpassword;

alter role regress_passwd2_new rename to regress_passwd2;

set password_encryption = md5;

alter role regress_passwd2 password 'foo';

alter role regress_passwd1 password 'md5cd3578025fe2c3d7ed1b9a9b26238b70';

alter role regress_passwd3
  password 'SCRAM-SHA-256$4096:VLK4RMaQLCvNtQ==$6YtlR4t69SguDiwFvbVgVZtuz6gpJQQqUMZ7IQJK5yI=:ps75jrHeYU4lXCcXI4O8oIdJ3eO8o2jirjruw9phBTo=';

set password_encryption = 'scram-sha-256';

alter role regress_passwd4 password 'foo';

create role regress_passwd5 password 'md5e73a4b11df52a6068f8b39f90be36023';

create role regress_passwd6 password 'SCRAM-SHA-256$1234';

create role regress_passwd7 password 'md5012345678901234567890123456789zz';

create role regress_passwd8 password 'md501234567890123456789012345678901zz';

set scram_iterations = 1024;

create role regress_passwd9 password 'alterediterationcount';

select
  rolname,
  regexp_replace(
    rolpassword,
    '(SCRAM-SHA-256)\$(\d+):([a-zA-Z0-9+/=]+)\$([a-zA-Z0-9+=/]+):([a-zA-Z0-9+/=]+)',
    '\1$\2:<salt>$<storedkey>:<serverkey>'
  )
  as rolpassword_masked
from
  pg_authid
where
  rolname like 'regress_passwd%'
order by rolname,
  rolpassword;

create role regress_passwd_empty password '';

alter role regress_passwd_empty password 'md585939a5ce845f1a1b620742e3c659e0a';

alter role regress_passwd_empty
  password 'SCRAM-SHA-256$4096:hpFyHTUsSWcR7O9P$LgZFIt6Oqdo27ZFKbZ2nV+vtnYM995pDh9ca6WSi120=:qVV5NeluNfUPkwm7Vqat25RjSPLkGeoZBQs6wVv+um4=';

select rolpassword from pg_authid where rolname = 'regress_passwd_empty';

create role regress_passwd_sha_len0
  password 'SCRAM-SHA-256$4096:A6xHKoH/494E941doaPOYg==$Ky+A30sewHIH3VHQLRN9vYsuzlgNyGNKCh37dy96Rqw=:COPdlNiIkrsacU5QoxydEuOH6e/KfiipeETb/bPw8ZI=';

create role regress_passwd_sha_len1
  password 'SCRAM-SHA-256$4096:A6xHKoH/494E941doaPOYg==$Ky+A30sewHIH3VHQLRN9vYsuzlgNyGNKCh37dy96RqwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=:COPdlNiIkrsacU5QoxydEuOH6e/KfiipeETb/bPw8ZI=';

create role regress_passwd_sha_len2
  password 'SCRAM-SHA-256$4096:A6xHKoH/494E941doaPOYg==$Ky+A30sewHIH3VHQLRN9vYsuzlgNyGNKCh37dy96Rqw=:COPdlNiIkrsacU5QoxydEuOH6e/KfiipeETb/bPw8ZIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=';

select
  rolname,
  rolpassword not like '%A6xHKoH/494E941doaPOYg==%'
  as is_rolpassword_rehashed
from
  pg_authid
where
  rolname like 'regress_passwd_sha_len%'
order by rolname;

create role regress_passwd10
  password 'SCRAM-SHA-256$000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004096:wNFxNSk1hAXBkgub8py3bg==$65zC6E+R0U7tiYTC9+Wtq4Thw6gUDj3eDCINij8TflU=:rC1I7tcVugrHEY2DT0iPjGyjM4aJxkMM9n8WBxtUtHU=';

alter role regress_passwd9
  password 'SCRAM-SHA-256$000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004096:wNFxNSk1hAXBkgub8py3bg==$65zC6E+R0U7tiYTC9+Wtq4Thw6gUDj3eDCINij8TflU=:rC1I7tcVugrHEY2DT0iPjGyjM4aJxkMM9n8WBxtUtHU=';

drop role regress_passwd1;

drop role regress_passwd2;

drop role regress_passwd3;

drop role regress_passwd4;

drop role regress_passwd5;

drop role regress_passwd6;

drop role regress_passwd7;

drop role regress_passwd8;

drop role regress_passwd9;

drop role regress_passwd_empty;

drop role regress_passwd_sha_len0;

drop role regress_passwd_sha_len1;

drop role regress_passwd_sha_len2;

select
  rolname,
  rolpassword
from
  pg_authid
where
  rolname like 'regress_passwd%'
order by rolname,
  rolpassword;
