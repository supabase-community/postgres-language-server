CREATE TABLE DEFAULT_TBL (i int DEFAULT 100,
	x text DEFAULT 'vadim', f float8 DEFAULT 123.456);

INSERT INTO DEFAULT_TBL VALUES (1, 'thomas', 57.0613);

INSERT INTO DEFAULT_TBL VALUES (1, 'bruce');

INSERT INTO DEFAULT_TBL (i, f) VALUES (2, 987.654);

INSERT INTO DEFAULT_TBL (x) VALUES ('marc');

INSERT INTO DEFAULT_TBL VALUES (3, null, 1.0);

SELECT * FROM DEFAULT_TBL;

CREATE SEQUENCE DEFAULT_SEQ;

CREATE TABLE DEFAULTEXPR_TBL (i1 int DEFAULT 100 + (200-199) * 2,
	i2 int DEFAULT nextval('default_seq'));

INSERT INTO DEFAULTEXPR_TBL VALUES (-1, -2);

INSERT INTO DEFAULTEXPR_TBL (i1) VALUES (-3);

INSERT INTO DEFAULTEXPR_TBL (i2) VALUES (-4);

INSERT INTO DEFAULTEXPR_TBL (i2) VALUES (NULL);

SELECT * FROM DEFAULTEXPR_TBL;

CREATE TABLE error_tbl (b1 bool DEFAULT (1 IN (1, 2)));

DROP TABLE error_tbl;

CREATE TABLE CHECK_TBL (x int,
	CONSTRAINT CHECK_CON CHECK (x > 3));

INSERT INTO CHECK_TBL VALUES (5);

INSERT INTO CHECK_TBL VALUES (4);

INSERT INTO CHECK_TBL VALUES (3);

INSERT INTO CHECK_TBL VALUES (2);

INSERT INTO CHECK_TBL VALUES (6);

INSERT INTO CHECK_TBL VALUES (1);

SELECT * FROM CHECK_TBL;

INSERT INTO NE_CHECK_TBL VALUES (5);

INSERT INTO NE_CHECK_TBL VALUES (4);

INSERT INTO NE_CHECK_TBL VALUES (3);

INSERT INTO NE_CHECK_TBL VALUES (2);

INSERT INTO NE_CHECK_TBL VALUES (6);

INSERT INTO NE_CHECK_TBL VALUES (1);

SELECT * FROM NE_CHECK_TBL;

CREATE SEQUENCE CHECK_SEQ;

CREATE TABLE CHECK2_TBL (x int, y text, z int,
	CONSTRAINT SEQUENCE_CON
	CHECK (x > 3 and y <> 'check failed' and z < 8));

INSERT INTO CHECK2_TBL VALUES (4, 'check ok', -2);

INSERT INTO CHECK2_TBL VALUES (1, 'x check failed', -2);

INSERT INTO CHECK2_TBL VALUES (5, 'z check failed', 10);

INSERT INTO CHECK2_TBL VALUES (0, 'check failed', -2);

INSERT INTO CHECK2_TBL VALUES (6, 'check failed', 11);

INSERT INTO CHECK2_TBL VALUES (7, 'check ok', 7);

SELECT * from CHECK2_TBL;

CREATE SEQUENCE INSERT_SEQ;

INSERT INTO INSERT_TBL(x,z) VALUES (2, -2);

SELECT * FROM INSERT_TBL;

SELECT 'one' AS one, nextval('insert_seq');

INSERT INTO INSERT_TBL(y) VALUES ('Y');

INSERT INTO INSERT_TBL(y) VALUES ('Y');

INSERT INTO INSERT_TBL(x,z) VALUES (1, -2);

INSERT INTO INSERT_TBL(z,x) VALUES (-7,  7);

INSERT INTO INSERT_TBL VALUES (5, 'check failed', -5);

INSERT INTO INSERT_TBL VALUES (7, '!check failed', -7);

INSERT INTO INSERT_TBL(y) VALUES ('-!NULL-');

SELECT * FROM INSERT_TBL;

INSERT INTO INSERT_TBL(y,z) VALUES ('check failed', 4);

INSERT INTO INSERT_TBL(x,y) VALUES (5, 'check failed');

INSERT INTO INSERT_TBL(x,y) VALUES (5, '!check failed');

INSERT INTO INSERT_TBL(y) VALUES ('-!NULL-');

SELECT * FROM INSERT_TBL;

SELECT 'seven' AS one, nextval('insert_seq');

INSERT INTO INSERT_TBL(y) VALUES ('Y');

SELECT 'eight' AS one, currval('insert_seq');

INSERT INTO INSERT_TBL VALUES (null, null, null);

SELECT * FROM INSERT_TBL;

CREATE TABLE SYS_COL_CHECK_TBL (city text, state text, is_capital bool,
                  altitude int,
                  CHECK (NOT (is_capital AND tableoid::regclass::text = 'sys_col_check_tbl')));

INSERT INTO SYS_COL_CHECK_TBL VALUES ('Seattle', 'Washington', false, 100);

INSERT INTO SYS_COL_CHECK_TBL VALUES ('Olympia', 'Washington', true, 100);

SELECT *, tableoid::regclass::text FROM SYS_COL_CHECK_TBL;

DROP TABLE SYS_COL_CHECK_TBL;

CREATE TABLE SYS_COL_CHECK_TBL (city text, state text, is_capital bool,
                  altitude int,
				  CHECK (NOT (is_capital AND ctid::text = 'sys_col_check_tbl')));

CREATE TABLE INSERT_CHILD (cx INT default 42,
	cy INT CHECK (cy > x))
	INHERITS (INSERT_TBL);

INSERT INTO INSERT_CHILD(x,z,cy) VALUES (7,-7,11);

INSERT INTO INSERT_CHILD(x,z,cy) VALUES (7,-7,6);

INSERT INTO INSERT_CHILD(x,z,cy) VALUES (6,-7,7);

INSERT INTO INSERT_CHILD(x,y,z,cy) VALUES (6,'check failed',-6,7);

SELECT * FROM INSERT_CHILD;

DROP TABLE INSERT_CHILD;

CREATE TABLE ATACC1 (TEST INT
	CHECK (TEST > 0) NO INHERIT);

CREATE TABLE ATACC2 (TEST2 INT) INHERITS (ATACC1);

INSERT INTO ATACC2 (TEST) VALUES (-3);

INSERT INTO ATACC1 (TEST) VALUES (-3);

DROP TABLE ATACC1 CASCADE;

CREATE TABLE ATACC1 (TEST INT, TEST2 INT
	CHECK (TEST > 0), CHECK (TEST2 > 10) NO INHERIT);

CREATE TABLE ATACC2 () INHERITS (ATACC1);

INSERT INTO ATACC2 (TEST) VALUES (-3);

INSERT INTO ATACC1 (TEST) VALUES (-3);

INSERT INTO ATACC2 (TEST2) VALUES (3);

INSERT INTO ATACC1 (TEST2) VALUES (3);

DROP TABLE ATACC1 CASCADE;

DELETE FROM INSERT_TBL;

ALTER SEQUENCE INSERT_SEQ RESTART
