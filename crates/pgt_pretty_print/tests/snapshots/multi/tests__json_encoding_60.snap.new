---
source: crates/pgt_pretty_print/tests/tests.rs
assertion_line: 174
input_file: crates/pgt_pretty_print/tests/data/multi/json_encoding_60.sql
---
SELECT
  getdatabaseencoding() NOT IN ('UTF8',
  'SQL_ASCII') AS "skip_test";

SELECT getdatabaseencoding();

SELECT CAST('"\u"' AS pg_catalog.json);

SELECT CAST('"\u00"' AS pg_catalog.json);

SELECT CAST('"\u000g"' AS pg_catalog.json);

SELECT CAST('"\u0000"' AS pg_catalog.json);

SELECT CAST('"\uaBcD"' AS pg_catalog.json);

SELECT
  CAST('{ "a":  "\ud83d\ude04\ud83d\udc36" }' AS pg_catalog.json) -> 'a' AS "correct_in_utf8";

SELECT
  CAST('{ "a":  "\ud83d\ud83d" }' AS pg_catalog.json) -> 'a';

SELECT
  CAST('{ "a":  "\ude04\ud83d" }' AS pg_catalog.json) -> 'a';

SELECT
  CAST('{ "a":  "\ud83dX" }' AS pg_catalog.json) -> 'a';

SELECT
  CAST('{ "a":  "\ude04X" }' AS pg_catalog.json) -> 'a';

SELECT
  CAST('{ "a":  "the Copyright \u00a9 sign" }' AS pg_catalog.json) AS "correct_in_utf8";

SELECT
  CAST('{ "a":  "dollar \u0024 character" }' AS pg_catalog.json) AS "correct_everywhere";

SELECT
  CAST('{ "a":  "dollar \\u0024 character" }' AS pg_catalog.json) AS "not_an_escape";

SELECT
  CAST('{ "a":  "null \u0000 escape" }' AS pg_catalog.json) AS "not_unescaped";

SELECT
  CAST('{ "a":  "null \\u0000 escape" }' AS pg_catalog.json) AS "not_an_escape";

SELECT
  CAST('{ "a":  "the Copyright \u00a9 sign" }' AS pg_catalog.json) ->> 'a' AS "correct_in_utf8";

SELECT
  CAST('{ "a":  "dollar \u0024 character" }' AS pg_catalog.json) ->> 'a' AS "correct_everywhere";

SELECT
  CAST('{ "a":  "dollar \\u0024 character" }' AS pg_catalog.json) ->> 'a' AS "not_an_escape";

SELECT
  CAST('{ "a":  "null \u0000 escape" }' AS pg_catalog.json) ->> 'a' AS "fails";

SELECT
  CAST('{ "a":  "null \\u0000 escape" }' AS pg_catalog.json) ->> 'a' AS "not_an_escape";

SELECT CAST('"\u"' AS jsonb);

SELECT CAST('"\u00"' AS jsonb);

SELECT CAST('"\u000g"' AS jsonb);

SELECT CAST('"\u0045"' AS jsonb);

SELECT CAST('"\u0000"' AS jsonb);

SELECT
  octet_length(CAST(CAST('"\uaBcD"' AS jsonb) AS text));

SELECT
  octet_length(CAST(CAST('{ "a":  "\ud83d\ude04\ud83d\udc36" }' AS jsonb) -> 'a' AS text)) AS "correct_in_utf8";

SELECT CAST('{ "a":  "\ud83d\ud83d" }' AS jsonb) -> 'a';

SELECT CAST('{ "a":  "\ude04\ud83d" }' AS jsonb) -> 'a';

SELECT CAST('{ "a":  "\ud83dX" }' AS jsonb) -> 'a';

SELECT CAST('{ "a":  "\ude04X" }' AS jsonb) -> 'a';

SELECT
  CAST('{ "a":  "the Copyright \u00a9 sign" }' AS jsonb) AS "correct_in_utf8";

SELECT
  CAST('{ "a":  "dollar \u0024 character" }' AS jsonb) AS "correct_everywhere";

SELECT
  CAST('{ "a":  "dollar \\u0024 character" }' AS jsonb) AS "not_an_escape";

SELECT
  CAST('{ "a":  "null \u0000 escape" }' AS jsonb) AS "fails";

SELECT
  CAST('{ "a":  "null \\u0000 escape" }' AS jsonb) AS "not_an_escape";

SELECT
  CAST('{ "a":  "the Copyright \u00a9 sign" }' AS jsonb) ->> 'a' AS "correct_in_utf8";

SELECT
  CAST('{ "a":  "dollar \u0024 character" }' AS jsonb) ->> 'a' AS "correct_everywhere";

SELECT
  CAST('{ "a":  "dollar \\u0024 character" }' AS jsonb) ->> 'a' AS "not_an_escape";

SELECT
  CAST('{ "a":  "null \u0000 escape" }' AS jsonb) ->> 'a' AS "fails";

SELECT
  CAST('{ "a":  "null \\u0000 escape" }' AS jsonb) ->> 'a' AS "not_an_escape";

SELECT
  *
FROM
  pg_input_error_info('{ "a":  "\ud83d\ude04\ud83d\udc36" }',
  'jsonb');
