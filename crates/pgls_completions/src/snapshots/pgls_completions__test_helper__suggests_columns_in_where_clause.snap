---
source: crates/pgls_completions/src/test_helper.rs
expression: final_snapshot
---
***Setup***

create table instruments (
    id bigint primary key generated always as identity,
    name text not null,
    z text, 
    created_at timestamp with time zone default now()
);

create table others (
    a text,
    b text,
    c text
);


--------------

select name from instruments i join others o on i.z = o.a |

Results:
cross - cross (Keyword)
except - except (Keyword)
for - for (Keyword)
full - full (Keyword)
group - group (Keyword)

--------------

select name from instruments i join others o on i.z = o.a w|

Results:
where - where (Keyword)
window - window (Keyword)

--------------

select name from instruments i join others o on i.z = o.a where |

Results:
o.a - public.others.a (Column)
o.b - public.others.b (Column)
o.c - public.others.c (Column)
i.created_at - public.instruments.created_at (Column)
i.id - public.instruments.id (Column)

--------------

select name from instruments i join others o on i.z = o.a where o.|
**should respect alias specification**

Results:
a - public.others.a (Column)
b - public.others.b (Column)
c - public.others.c (Column)

--------------

select name from instruments i join others o on i.z = o.a where o.a |

Results:
except - except (Keyword)
for - for (Keyword)
group - group (Keyword)
intersect - intersect (Keyword)
limit - limit (Keyword)

--------------

select name from instruments i join others o on i.z = o.a where o.a = |
**should not prioritize suggest columns or schemas (right side of binary expression)**

Results:
o.b - public.others.b (Column)
o.c - public.others.c (Column)
i.created_at - public.instruments.created_at (Column)
i.id - public.instruments.id (Column)
i.name - public.instruments.name (Column)

--------------

select name from instruments i join others o on i.z = o.a where o.a = i.|

Results:
created_at - public.instruments.created_at (Column)
id - public.instruments.id (Column)
name - public.instruments.name (Column)
z - public.instruments.z (Column)

--------------

select name from instruments i join others o on i.z = o.a where o.a = i.z |

Results:
except - except (Keyword)
for - for (Keyword)
group - group (Keyword)
intersect - intersect (Keyword)
limit - limit (Keyword)

--------------

select name from instruments i join others o on i.z = o.a where o.a = i.z a|

Results:
and - and (Keyword)

--------------

select name from instruments i join others o on i.z = o.a where o.a = i.z and |
**should prioritize columns that aren't already mentioned**

Results:
o.b - public.others.b (Column)
o.c - public.others.c (Column)
i.created_at - public.instruments.created_at (Column)
i.id - public.instruments.id (Column)
i.name - public.instruments.name (Column)

--------------

select name from instruments i join others o on i.z = o.a where o.a = i.z and i.|

Results:
created_at - public.instruments.created_at (Column)
id - public.instruments.id (Column)
name - public.instruments.name (Column)
z - public.instruments.z (Column)

--------------

select name from instruments i join others o on i.z = o.a where o.a = i.z and i.i|

Results:
id - public.instruments.id (Column)

--------------

select name from instruments i join others o on i.z = o.a where o.a = i.z and i.id |

Results:
except - except (Keyword)
for - for (Keyword)
group - group (Keyword)
intersect - intersect (Keyword)
limit - limit (Keyword)

--------------

select name from instruments i join others o on i.z = o.a where o.a = i.z and i.id > |

Results:
o.b - public.others.b (Column)
o.c - public.others.c (Column)
i.created_at - public.instruments.created_at (Column)
i.name - public.instruments.name (Column)
i.z - public.instruments.z (Column)

--------------

select name from instruments i join others o on i.z = o.a where o.a = i.z and i.id > 5|
select name from instruments i join others o on i.z = o.a where o.a = i.z and i.id > 5; |

Results:
copy - copy (Keyword)
create - create (Keyword)
drop - drop (Keyword)
insert - insert (Keyword)
reset - reset (Keyword)

--------------
