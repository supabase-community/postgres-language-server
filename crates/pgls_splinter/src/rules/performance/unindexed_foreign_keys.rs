//! Generated file, do not edit by hand, see `xtask/codegen`

#![doc = r" Generated file, do not edit by hand, see `xtask/codegen`"]
use crate::rule::SplinterRule;
::pgls_analyse::declare_rule! { # [doc = "# Unindexed foreign keys\n\nIdentifies foreign key constraints without a covering index, which can impact database performance.\n\n## SQL Query\n\n```sql\nwith foreign_keys as (\n    select\n        cl.relnamespace::regnamespace::text as schema_name,\n        cl.relname as table_name,\n        cl.oid as table_oid,\n        ct.conname as fkey_name,\n        ct.conkey as col_attnums\n    from\n        pg_catalog.pg_constraint ct\n        join pg_catalog.pg_class cl -- fkey owning table\n            on ct.conrelid = cl.oid\n        left join pg_catalog.pg_depend d\n            on d.objid = cl.oid\n            and d.deptype = 'e'\n    where\n        ct.contype = 'f' -- foreign key constraints\n        and d.objid is null -- exclude tables that are dependencies of extensions\n        and cl.relnamespace::regnamespace::text not in (\n            'pg_catalog', 'information_schema', 'auth', 'storage', 'vault', 'extensions'\n        )\n),\nindex_ as (\n    select\n        pi.indrelid as table_oid,\n        indexrelid::regclass as index_,\n        string_to_array(indkey::text, ' ')::smallint[] as col_attnums\n    from\n        pg_catalog.pg_index pi\n    where\n        indisvalid\n)\nselect\n    'unindexed_foreign_keys' as \"name!\",\n    'Unindexed foreign keys' as \"title!\",\n    'INFO' as \"level!\",\n    'EXTERNAL' as \"facing!\",\n    array['PERFORMANCE'] as \"categories!\",\n    'Identifies foreign key constraints without a covering index, which can impact database performance.' as \"description!\",\n    format(\n        'Table `%s.%s` has a foreign key `%s` without a covering index. This can lead to suboptimal query performance.',\n        fk.schema_name,\n        fk.table_name,\n        fk.fkey_name\n    ) as \"detail!\",\n    'https://supabase.com/docs/guides/database/database-linter?lint=0001_unindexed_foreign_keys' as \"remediation!\",\n    jsonb_build_object(\n        'schema', fk.schema_name,\n        'name', fk.table_name,\n        'type', 'table',\n        'fkey_name', fk.fkey_name,\n        'fkey_columns', fk.col_attnums\n    ) as \"metadata!\",\n    format('unindexed_foreign_keys_%s_%s_%s', fk.schema_name, fk.table_name, fk.fkey_name) as \"cache_key!\"\nfrom\n    foreign_keys fk\n    left join index_ idx\n        on fk.table_oid = idx.table_oid\n        and fk.col_attnums = idx.col_attnums[1:array_length(fk.col_attnums, 1)]\n    left join pg_catalog.pg_depend dep\n        on idx.table_oid = dep.objid\n        and dep.deptype = 'e'\nwhere\n    idx.index_ is null\n    and fk.schema_name not in (\n        '_timescaledb_cache', '_timescaledb_catalog', '_timescaledb_config', '_timescaledb_internal', 'auth', 'cron', 'extensions', 'graphql', 'graphql_public', 'information_schema', 'net', 'pgmq', 'pgroonga', 'pgsodium', 'pgsodium_masks', 'pgtle', 'pgbouncer', 'pg_catalog', 'pgtle', 'realtime', 'repack', 'storage', 'supabase_functions', 'supabase_migrations', 'tiger', 'topology', 'vault'\n    )\n    and dep.objid is null -- exclude tables owned by extensions\norder by\n    fk.schema_name,\n    fk.table_name,\n    fk.fkey_name\n```\n\n## Configuration\n\nEnable or disable this rule in your configuration:\n\n```json\n{\n  \"splinter\": {\n    \"rules\": {\n      \"performance\": {\n        \"unindexedForeignKeys\": \"warn\"\n      }\n    }\n  }\n}\n```\n\n## Remediation\n\nSee: <https://supabase.com/docs/guides/database/database-linter?lint=0001_unindexed_foreign_keys>"] pub UnindexedForeignKeys { version : "1.0.0" , name : "unindexedForeignKeys" , severity : pgls_diagnostics :: Severity :: Information , recommended : true , } }
impl SplinterRule for UnindexedForeignKeys {
    const SQL_FILE_PATH: &'static str = "performance/unindexed_foreign_keys.sql";
    const DESCRIPTION: &'static str = "Identifies foreign key constraints without a covering index, which can impact database performance.";
    const REMEDIATION: &'static str = "https://supabase.com/docs/guides/database/database-linter?lint=0001_unindexed_foreign_keys";
    const REQUIRES_SUPABASE: bool = false;
}
